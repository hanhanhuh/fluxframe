==================================
Pooling Method Comparison
==================================
Testing all pooling configurations
Saving comparison samples for visual inspection

1/5: Avg + 2x2 grid (baseline)
18:57:17 - INFO - Video: /home/birgit/Downloads/Winter Cycling： Vantaa, Finland - 4K 60fps.mp4
18:57:17 - INFO - Image folder: /home/birgit/fiftyone/open-images-v7/train/data
18:57:17 - INFO - Output directory: output_avg_2x2
18:57:17 - INFO - Search depth: 10
18:57:17 - INFO - Similarity threshold: 0.0
18:57:17 - INFO - No repeat: True
18:57:17 - INFO - Checkpoint batch size: 10
18:57:17 - INFO - Feature method: mobilenet
18:57:17 - INFO - Demo mode: ON (max 10s video, 1000 images)
18:57:17 - INFO - Weights - Edge: 0.60, Texture: 0.20, Color: 0.20
18:57:18 - INFO - FPS override: 25.0 (input: 59.94, skip interval: 2)
18:57:18 - INFO - Demo mode: Processing first 10 seconds (599 frames) out of 123084
18:57:18 - INFO - Scanning image folder...
18:59:04 - INFO - Sorting 467000 image paths...
18:59:25 - INFO - Demo mode: Using first 1000 images out of 467000
18:59:27 - INFO - Found 1000 images in folder
18:59:27 - INFO - Preparing FAISS index...
18:59:27 - INFO - Cache files not found, will rebuild
18:59:27 - INFO - Building FAISS index for 1000 images...
18:59:27 - INFO -   Comparison size: 256px
18:59:27 - INFO -   Using single-process mode (ONNX Runtime handles threading)
Computing features:   0%|          | 0/1000 [00:00<?, ?it/s]Computing features:   0%|          | 5/1000 [00:00<01:45,  9.43it/s]Computing features:   1%|          | 11/1000 [00:01<01:41,  9.74it/s]Computing features:   2%|▏         | 16/1000 [00:01<01:41,  9.72it/s]Computing features:   2%|▏         | 21/1000 [00:02<01:43,  9.49it/s]Computing features:   3%|▎         | 27/1000 [00:02<01:41,  9.57it/s]Computing features:   3%|▎         | 32/1000 [00:03<01:42,  9.48it/s]Computing features:   4%|▎         | 37/1000 [00:03<01:44,  9.23it/s]Computing features:   4%|▍         | 43/1000 [00:04<01:43,  9.29it/s]Computing features:   5%|▍         | 49/1000 [00:05<01:40,  9.47it/s]Computing features:   5%|▌         | 54/1000 [00:05<01:39,  9.50it/s]Computing features:   6%|▌         | 59/1000 [00:06<01:39,  9.45it/s]Computing features:   6%|▋         | 64/1000 [00:06<01:40,  9.31it/s]Computing features:   7%|▋         | 69/1000 [00:07<01:40,  9.27it/s]Computing features:   7%|▋         | 74/1000 [00:07<01:40,  9.19it/s]Computing features:   8%|▊         | 79/1000 [00:08<01:39,  9.26it/s]Computing features:   8%|▊         | 84/1000 [00:09<01:38,  9.30it/s]Computing features:   9%|▉         | 89/1000 [00:09<01:37,  9.31it/s]Computing features:   9%|▉         | 94/1000 [00:10<01:40,  9.04it/s]Computing features:  10%|▉         | 99/1000 [00:10<01:39,  9.01it/s]Computing features:  10%|█         | 105/1000 [00:11<01:37,  9.14it/s]Computing features:  11%|█         | 111/1000 [00:11<01:35,  9.26it/s]Computing features:  12%|█▏        | 117/1000 [00:12<01:33,  9.40it/s]Computing features:  12%|█▎        | 125/1000 [00:13<01:29,  9.73it/s]Computing features:  13%|█▎        | 130/1000 [00:13<01:29,  9.73it/s]Computing features:  14%|█▎        | 135/1000 [00:14<01:29,  9.70it/s]Computing features:  14%|█▍        | 140/1000 [00:14<01:28,  9.69it/s]Computing features:  14%|█▍        | 145/1000 [00:15<01:29,  9.52it/s]Computing features:  15%|█▌        | 150/1000 [00:15<01:30,  9.37it/s]Computing features:  16%|█▌        | 155/1000 [00:16<01:31,  9.19it/s]Computing features:  16%|█▌        | 160/1000 [00:17<01:32,  9.08it/s]Computing features:  16%|█▋        | 165/1000 [00:17<01:32,  9.00it/s]Computing features:  17%|█▋        | 172/1000 [00:18<01:29,  9.25it/s]Computing features:  18%|█▊        | 180/1000 [00:19<01:25,  9.59it/s]Computing features:  19%|█▊        | 187/1000 [00:19<01:23,  9.77it/s]Computing features:  20%|█▉        | 195/1000 [00:20<01:20, 10.06it/s]Computing features:  20%|██        | 203/1000 [00:20<01:17, 10.27it/s]Computing features:  21%|██        | 210/1000 [00:21<01:15, 10.44it/s]Computing features:  22%|██▏       | 218/1000 [00:21<01:13, 10.70it/s]Computing features:  22%|██▎       | 225/1000 [00:22<01:11, 10.84it/s]Computing features:  23%|██▎       | 231/1000 [00:22<01:10, 10.87it/s]Computing features:  24%|██▍       | 240/1000 [00:23<01:08, 11.14it/s]Computing features:  25%|██▍       | 249/1000 [00:23<01:05, 11.39it/s]Computing features:  26%|██▌       | 255/1000 [00:24<01:05, 11.38it/s]Computing features:  26%|██▌       | 261/1000 [00:24<01:04, 11.39it/s]Computing features:  27%|██▋       | 268/1000 [00:25<01:03, 11.50it/s]Computing features:  27%|██▋       | 274/1000 [00:26<01:03, 11.42it/s]Computing features:  28%|██▊       | 280/1000 [00:26<01:02, 11.43it/s]Computing features:  29%|██▊       | 286/1000 [00:27<01:03, 11.31it/s]Computing features:  29%|██▉       | 292/1000 [00:27<01:02, 11.25it/s]Computing features:  30%|██▉       | 298/1000 [00:28<01:02, 11.17it/s]Computing features:  30%|███       | 305/1000 [00:28<01:01, 11.29it/s]Computing features:  31%|███       | 311/1000 [00:29<01:02, 10.98it/s]Computing features:  32%|███▏      | 317/1000 [00:30<01:02, 11.01it/s]Computing features:  32%|███▏      | 324/1000 [00:30<01:01, 11.08it/s]Computing features:  33%|███▎      | 330/1000 [00:31<01:00, 11.09it/s]Computing features:  34%|███▎      | 336/1000 [00:31<01:00, 11.05it/s]Computing features:  34%|███▍      | 343/1000 [00:32<00:59, 11.11it/s]Computing features:  35%|███▌      | 350/1000 [00:33<00:58, 11.19it/s]Computing features:  36%|███▌      | 358/1000 [00:33<00:56, 11.38it/s]Computing features:  36%|███▋      | 365/1000 [00:34<00:55, 11.44it/s]Computing features:  37%|███▋      | 371/1000 [00:34<00:54, 11.45it/s]Computing features:  38%|███▊      | 378/1000 [00:35<00:53, 11.56it/s]Computing features:  38%|███▊      | 384/1000 [00:35<00:53, 11.55it/s]Computing features:  39%|███▉      | 390/1000 [00:36<00:54, 11.25it/s]Computing features:  40%|███▉      | 396/1000 [00:37<00:56, 10.67it/s]Computing features:  40%|████      | 402/1000 [00:38<00:58, 10.22it/s]Computing features:  41%|████      | 408/1000 [00:39<00:59,  9.88it/s]Computing features:  41%|████▏     | 414/1000 [00:40<01:00,  9.71it/s]Computing features:  42%|████▏     | 420/1000 [00:41<01:00,  9.57it/s]Computing features:  43%|████▎     | 426/1000 [00:42<00:59,  9.57it/s]Computing features:  43%|████▎     | 433/1000 [00:42<00:58,  9.70it/s]Computing features:  44%|████▍     | 439/1000 [00:43<00:57,  9.70it/s]Computing features:  44%|████▍     | 445/1000 [00:43<00:57,  9.64it/s]Computing features:  45%|████▌     | 451/1000 [00:44<00:58,  9.46it/s]Computing features:  46%|████▌     | 457/1000 [00:45<00:58,  9.32it/s]Computing features:  46%|████▌     | 462/1000 [00:46<00:59,  9.12it/s]Computing features:  47%|████▋     | 467/1000 [00:47<00:59,  8.97it/s]Computing features:  47%|████▋     | 472/1000 [00:47<00:59,  8.88it/s]Computing features:  48%|████▊     | 477/1000 [00:48<00:59,  8.79it/s]Computing features:  48%|████▊     | 482/1000 [00:49<00:58,  8.81it/s]Computing features:  49%|████▊     | 487/1000 [00:49<00:58,  8.79it/s]Computing features:  49%|████▉     | 493/1000 [00:50<00:57,  8.85it/s]Computing features:  50%|████▉     | 498/1000 [00:50<00:56,  8.89it/s]Computing features:  50%|█████     | 504/1000 [00:51<00:55,  8.95it/s]Computing features:  51%|█████     | 510/1000 [00:51<00:54,  9.02it/s]Computing features:  52%|█████▏    | 515/1000 [00:52<00:53,  9.04it/s]Computing features:  52%|█████▏    | 520/1000 [00:53<00:53,  9.01it/s]Computing features:  52%|█████▎    | 525/1000 [00:53<00:52,  9.00it/s]Computing features:  53%|█████▎    | 530/1000 [00:54<00:52,  9.02it/s]Computing features:  54%|█████▎    | 537/1000 [00:54<00:50,  9.16it/s]Computing features:  54%|█████▍    | 543/1000 [00:55<00:49,  9.20it/s]Computing features:  55%|█████▍    | 548/1000 [00:56<00:49,  9.14it/s]Computing features:  55%|█████▌    | 553/1000 [00:56<00:48,  9.16it/s]Computing features:  56%|█████▌    | 558/1000 [00:57<00:48,  9.16it/s]Computing features:  56%|█████▋    | 563/1000 [00:57<00:47,  9.17it/s]Computing features:  57%|█████▋    | 568/1000 [00:58<00:47,  9.12it/s]Computing features:  57%|█████▋    | 574/1000 [00:58<00:46,  9.20it/s]Computing features:  58%|█████▊    | 581/1000 [00:59<00:44,  9.35it/s]Computing features:  59%|█████▊    | 586/1000 [00:59<00:44,  9.37it/s]Computing features:  59%|█████▉    | 592/1000 [01:00<00:43,  9.48it/s]Computing features:  60%|█████▉    | 597/1000 [01:00<00:42,  9.50it/s]Computing features:  60%|██████    | 604/1000 [01:01<00:41,  9.62it/s]Computing features:  61%|██████    | 610/1000 [01:01<00:40,  9.70it/s]Computing features:  62%|██████▏   | 617/1000 [01:02<00:39,  9.79it/s]Computing features:  62%|██████▏   | 623/1000 [01:03<00:38,  9.79it/s]Computing features:  63%|██████▎   | 629/1000 [01:03<00:38,  9.75it/s]Computing features:  64%|██████▎   | 635/1000 [01:04<00:37,  9.83it/s]Computing features:  64%|██████▍   | 641/1000 [01:04<00:36,  9.85it/s]Computing features:  65%|██████▍   | 647/1000 [01:05<00:36,  9.77it/s]Computing features:  65%|██████▌   | 652/1000 [01:06<00:35,  9.75it/s]Computing features:  66%|██████▌   | 657/1000 [01:06<00:35,  9.75it/s]Computing features:  66%|██████▌   | 662/1000 [01:07<00:34,  9.72it/s]Computing features:  67%|██████▋   | 669/1000 [01:07<00:33,  9.87it/s]Computing features:  68%|██████▊   | 675/1000 [01:08<00:33,  9.84it/s]Computing features:  68%|██████▊   | 681/1000 [01:08<00:32,  9.88it/s]Computing features:  69%|██████▊   | 687/1000 [01:09<00:31,  9.92it/s]Computing features:  69%|██████▉   | 693/1000 [01:10<00:30,  9.96it/s]Computing features:  70%|██████▉   | 699/1000 [01:10<00:30,  9.96it/s]Computing features:  70%|███████   | 705/1000 [01:11<00:29,  9.92it/s]Computing features:  71%|███████   | 711/1000 [01:11<00:29,  9.93it/s]Computing features:  72%|███████▏  | 717/1000 [01:12<00:28, 10.02it/s]Computing features:  72%|███████▏  | 723/1000 [01:13<00:27, 10.05it/s]Computing features:  73%|███████▎  | 729/1000 [01:13<00:26, 10.06it/s]Computing features:  74%|███████▎  | 735/1000 [01:14<00:26, 10.09it/s]Computing features:  74%|███████▍  | 741/1000 [01:14<00:25, 10.06it/s]Computing features:  75%|███████▍  | 748/1000 [01:15<00:24, 10.13it/s]Computing features:  75%|███████▌  | 754/1000 [01:16<00:24, 10.13it/s]Computing features:  76%|███████▌  | 760/1000 [01:16<00:23, 10.11it/s]Computing features:  77%|███████▋  | 766/1000 [01:17<00:23, 10.17it/s]Computing features:  77%|███████▋  | 773/1000 [01:17<00:22, 10.28it/s]Computing features:  78%|███████▊  | 779/1000 [01:18<00:21, 10.27it/s]Computing features:  78%|███████▊  | 785/1000 [01:18<00:20, 10.28it/s]Computing features:  79%|███████▉  | 791/1000 [01:19<00:20, 10.27it/s]Computing features:  80%|███████▉  | 798/1000 [01:20<00:19, 10.39it/s]Computing features:  80%|████████  | 805/1000 [01:20<00:18, 10.51it/s]Computing features:  81%|████████  | 811/1000 [01:21<00:18, 10.49it/s]Computing features:  82%|████████▏ | 817/1000 [01:21<00:17, 10.45it/s]Computing features:  82%|████████▏ | 823/1000 [01:22<00:17, 10.38it/s]Computing features:  83%|████████▎ | 829/1000 [01:23<00:16, 10.23it/s]Computing features:  84%|████████▎ | 835/1000 [01:23<00:16, 10.23it/s]Computing features:  84%|████████▍ | 841/1000 [01:24<00:15, 10.26it/s]Computing features:  85%|████████▍ | 847/1000 [01:24<00:14, 10.29it/s]Computing features:  85%|████████▌ | 853/1000 [01:25<00:14, 10.10it/s]Computing features:  86%|████████▌ | 860/1000 [01:26<00:13, 10.21it/s]Computing features:  87%|████████▋ | 866/1000 [01:26<00:13, 10.20it/s]Computing features:  87%|████████▋ | 873/1000 [01:27<00:12, 10.31it/s]Computing features:  88%|████████▊ | 879/1000 [01:27<00:11, 10.30it/s]Computing features:  88%|████████▊ | 885/1000 [01:28<00:11, 10.23it/s]Computing features:  89%|████████▉ | 891/1000 [01:29<00:10, 10.27it/s]Computing features:  90%|████████▉ | 897/1000 [01:29<00:09, 10.32it/s]Computing features:  90%|█████████ | 903/1000 [01:30<00:09, 10.24it/s]Computing features:  91%|█████████ | 909/1000 [01:31<00:08, 10.19it/s]Computing features:  92%|█████████▏| 915/1000 [01:31<00:08, 10.18it/s]Computing features:  92%|█████████▏| 921/1000 [01:32<00:07, 10.14it/s]Computing features:  93%|█████████▎| 928/1000 [01:32<00:07, 10.23it/s]Computing features:  94%|█████████▎| 935/1000 [01:33<00:06, 10.32it/s]Computing features:  94%|█████████▍| 941/1000 [01:34<00:05, 10.27it/s]Computing features:  95%|█████████▍| 947/1000 [01:34<00:05, 10.23it/s]Computing features:  95%|█████████▌| 953/1000 [01:35<00:04, 10.19it/s]Computing features:  96%|█████████▌| 959/1000 [01:35<00:03, 10.26it/s]Computing features:  96%|█████████▋| 965/1000 [01:36<00:03, 10.24it/s]Computing features:  97%|█████████▋| 971/1000 [01:37<00:02, 10.20it/s]Computing features:  98%|█████████▊| 978/1000 [01:37<00:02, 10.30it/s]Computing features:  98%|█████████▊| 984/1000 [01:38<00:01, 10.13it/s]Computing features:  99%|█████████▉| 990/1000 [01:39<00:00, 10.01it/s]Computing features: 100%|█████████▉| 996/1000 [01:39<00:00,  9.92it/s]Computing features: 100%|██████████| 1000/1000 [01:40<00:00,  9.97it/s]
19:01:07 - INFO - Built flat FAISS index: 1000 images, dimension 96
19:01:07 - INFO - Saving FAISS cache...
19:01:07 - INFO - FAISS cache saved successfully
19:01:07 - INFO - Video aspect ratio: 1.778
19:01:07 - INFO - Processing 599 frames...
Matching frames:   0%|          | 0/599 [00:00<?, ?it/s]Matching frames:   3%|▎         | 15/599 [00:00<00:21, 27.43it/s]Matching frames:   6%|▌         | 33/599 [00:01<00:17, 31.55it/s]Matching frames:   9%|▊         | 51/599 [00:01<00:17, 32.03it/s]Matching frames:  11%|█▏        | 68/599 [00:02<00:16, 31.75it/s]Matching frames:  14%|█▍        | 84/599 [00:02<00:16, 30.73it/s]Matching frames:  17%|█▋        | 100/599 [00:03<00:16, 29.83it/s]Matching frames:  19%|█▉        | 116/599 [00:04<00:16, 28.68it/s]Matching frames:  22%|██▏       | 131/599 [00:04<00:16, 28.14it/s]Matching frames:  24%|██▍       | 146/599 [00:05<00:17, 25.72it/s]Matching frames:  27%|██▋       | 161/599 [00:06<00:16, 25.77it/s]Matching frames:  29%|██▉       | 175/599 [00:06<00:16, 25.11it/s]Matching frames:  31%|███▏      | 188/599 [00:07<00:16, 24.52it/s]Matching frames:  34%|███▎      | 201/599 [00:08<00:16, 23.97it/s]Matching frames:  37%|███▋      | 219/599 [00:08<00:15, 24.72it/s]Matching frames:  40%|███▉      | 237/599 [00:09<00:14, 25.45it/s]Matching frames:  42%|████▏     | 251/599 [00:09<00:13, 25.43it/s]Matching frames:  44%|████▍     | 265/599 [00:10<00:13, 25.56it/s]Matching frames:  47%|████▋     | 279/599 [00:10<00:12, 25.21it/s]Matching frames:  49%|████▉     | 293/599 [00:11<00:12, 25.32it/s]Matching frames:  51%|█████     | 306/599 [00:12<00:12, 23.82it/s]Matching frames:  53%|█████▎    | 319/599 [00:13<00:11, 23.58it/s]Matching frames:  56%|█████▌    | 335/599 [00:13<00:10, 24.03it/s]Matching frames:  58%|█████▊    | 348/599 [00:14<00:10, 24.02it/s]Matching frames:  60%|██████    | 361/599 [00:15<00:10, 23.07it/s]Matching frames:  63%|██████▎   | 379/599 [00:15<00:09, 23.56it/s]Matching frames:  66%|██████▌   | 393/599 [00:16<00:08, 23.80it/s]Matching frames:  68%|██████▊   | 406/599 [00:16<00:08, 23.37it/s]Matching frames:  70%|██████▉   | 419/599 [00:17<00:07, 22.93it/s]Matching frames:  72%|███████▏  | 433/599 [00:18<00:07, 23.17it/s]Matching frames:  75%|███████▍  | 448/599 [00:18<00:06, 23.50it/s]Matching frames:  77%|███████▋  | 461/599 [00:19<00:06, 22.78it/s]Matching frames:  79%|███████▉  | 473/599 [00:20<00:05, 22.50it/s]Matching frames:  81%|████████  | 485/599 [00:20<00:05, 22.28it/s]Matching frames:  83%|████████▎ | 497/599 [00:21<00:04, 22.16it/s]Matching frames:  85%|████████▍ | 509/599 [00:22<00:04, 21.32it/s]Matching frames:  87%|████████▋ | 521/599 [00:23<00:03, 20.10it/s]Matching frames:  89%|████████▉ | 536/599 [00:24<00:03, 20.52it/s]Matching frames:  92%|█████████▏| 553/599 [00:24<00:02, 21.05it/s]Matching frames:  94%|█████████▍| 565/599 [00:25<00:01, 21.09it/s]Matching frames:  97%|█████████▋| 579/599 [00:25<00:00, 21.10it/s]Matching frames:  99%|█████████▉| 593/599 [00:26<00:00, 21.38it/s]Matching frames: 100%|██████████| 599/599 [00:26<00:00, 22.47it/s]
19:01:34 - INFO - Results saved to output_avg_2x2/results.json
19:01:34 - INFO - Verification: All frames have valid selections
19:01:35 - INFO - Generating output...
19:01:35 - INFO - Output FPS: 25.0 (input: 59.94)
Generating output:   0%|          | 0/300 [00:00<?, ?it/s]Generating output:   2%|▏         | 6/300 [00:00<00:25, 11.75it/s]Generating output:   5%|▌         | 15/300 [00:01<00:20, 14.07it/s]Generating output:   8%|▊         | 23/300 [00:01<00:19, 14.39it/s]Generating output:  10%|█         | 31/300 [00:02<00:18, 14.20it/s]Generating output:  13%|█▎        | 39/300 [00:02<00:18, 14.14it/s]Generating output:  16%|█▌        | 47/300 [00:03<00:18, 14.05it/s]Generating output:  18%|█▊        | 55/300 [00:04<00:18, 13.54it/s]Generating output:  21%|██        | 62/300 [00:04<00:17, 13.44it/s]Generating output:  23%|██▎       | 69/300 [00:05<00:17, 13.35it/s]Generating output:  25%|██▌       | 76/300 [00:05<00:16, 13.23it/s]Generating output:  28%|██▊       | 83/300 [00:06<00:16, 13.05it/s]Generating output:  30%|███       | 90/300 [00:06<00:16, 12.88it/s]Generating output:  32%|███▏      | 97/300 [00:07<00:15, 12.79it/s]Generating output:  35%|███▍      | 104/300 [00:08<00:15, 12.64it/s]Generating output:  37%|███▋      | 111/300 [00:08<00:15, 12.39it/s]Generating output:  40%|███▉      | 119/300 [00:09<00:14, 12.55it/s]Generating output:  42%|████▏     | 126/300 [00:09<00:13, 12.58it/s]Generating output:  44%|████▍     | 133/300 [00:10<00:13, 12.59it/s]Generating output:  47%|████▋     | 140/300 [00:11<00:12, 12.44it/s]Generating output:  49%|████▉     | 147/300 [00:11<00:12, 12.26it/s]Generating output:  51%|█████▏    | 154/300 [00:12<00:12, 12.11it/s]Generating output:  54%|█████▎    | 161/300 [00:13<00:11, 11.92it/s]Generating output:  56%|█████▌    | 168/300 [00:13<00:11, 11.74it/s]Generating output:  58%|█████▊    | 174/300 [00:14<00:10, 11.52it/s]Generating output:  60%|██████    | 180/300 [00:15<00:10, 11.48it/s]Generating output:  62%|██████▏   | 186/300 [00:15<00:10, 11.35it/s]Generating output:  64%|██████▍   | 192/300 [00:16<00:09, 11.20it/s]Generating output:  66%|██████▌   | 198/300 [00:17<00:09, 11.04it/s]Generating output:  68%|██████▊   | 204/300 [00:17<00:08, 10.92it/s]Generating output:  70%|███████   | 210/300 [00:18<00:08, 10.67it/s]Generating output:  72%|███████▏  | 216/300 [00:19<00:07, 10.66it/s]Generating output:  74%|███████▍  | 222/300 [00:19<00:07, 10.61it/s]Generating output:  76%|███████▌  | 228/300 [00:20<00:06, 10.61it/s]Generating output:  78%|███████▊  | 234/300 [00:20<00:06, 10.65it/s]Generating output:  80%|████████  | 240/300 [00:21<00:05, 10.53it/s]Generating output:  82%|████████▏ | 246/300 [00:21<00:05, 10.51it/s]Generating output:  84%|████████▍ | 252/300 [00:22<00:04, 10.56it/s]Generating output:  86%|████████▌ | 258/300 [00:23<00:03, 10.59it/s]Generating output:  88%|████████▊ | 264/300 [00:23<00:03, 10.65it/s]Generating output:  90%|█████████ | 270/300 [00:24<00:02, 10.68it/s]Generating output:  92%|█████████▏| 276/300 [00:24<00:02, 10.70it/s]Generating output:  94%|█████████▍| 282/300 [00:25<00:01, 10.74it/s]Generating output:  96%|█████████▌| 288/300 [00:25<00:01, 10.74it/s]Generating output:  98%|█████████▊| 294/300 [00:26<00:00, 10.70it/s]Generating output: 100%|██████████| 300/300 [00:26<00:00, 11.20it/s]
19:02:02 - INFO - Output video saved to: output_avg_2x2/Winter Cycling： Vantaa, Finland - 4K 60fps_matched.mp4
19:02:02 - INFO - Output images saved to: output_avg_2x2/matched_frames

Done!

real	4m47,395s
user	10m32,576s
sys	1m5,760s

2/5: Avg + 3x3 grid
19:02:04 - INFO - Video: /home/birgit/Downloads/Winter Cycling： Vantaa, Finland - 4K 60fps.mp4
19:02:04 - INFO - Image folder: /home/birgit/fiftyone/open-images-v7/train/data
19:02:04 - INFO - Output directory: output_avg_3x3
19:02:04 - INFO - Search depth: 10
19:02:04 - INFO - Similarity threshold: 0.0
19:02:04 - INFO - No repeat: True
19:02:04 - INFO - Checkpoint batch size: 10
19:02:04 - INFO - Feature method: mobilenet
19:02:04 - INFO - Demo mode: ON (max 10s video, 1000 images)
19:02:04 - INFO - Weights - Edge: 0.60, Texture: 0.20, Color: 0.20
19:02:04 - INFO - FPS override: 25.0 (input: 59.94, skip interval: 2)
19:02:04 - INFO - Demo mode: Processing first 10 seconds (599 frames) out of 123084
19:02:04 - INFO - Scanning image folder...
19:03:17 - INFO - Sorting 467000 image paths...
19:03:36 - INFO - Demo mode: Using first 1000 images out of 467000
19:03:38 - INFO - Found 1000 images in folder
19:03:38 - INFO - Preparing FAISS index...
19:03:38 - INFO - Cache files not found, will rebuild
19:03:38 - INFO - Building FAISS index for 1000 images...
19:03:38 - INFO -   Comparison size: 256px
19:03:38 - INFO -   Using single-process mode (ONNX Runtime handles threading)
Computing features:   0%|          | 0/1000 [00:00<?, ?it/s]Computing features:   1%|          | 7/1000 [00:00<01:16, 13.00it/s]Computing features:   1%|▏         | 14/1000 [00:01<01:39,  9.91it/s]Computing features:   2%|▏         | 20/1000 [00:02<01:46,  9.21it/s]Computing features:   2%|▎         | 25/1000 [00:02<01:48,  8.99it/s]Computing features:   3%|▎         | 30/1000 [00:03<01:48,  8.95it/s]Computing features:   4%|▎         | 36/1000 [00:03<01:45,  9.12it/s]Computing features:   4%|▍         | 41/1000 [00:04<01:46,  9.04it/s]Computing features:   5%|▍         | 47/1000 [00:05<01:42,  9.34it/s]Computing features:   5%|▌         | 53/1000 [00:05<01:39,  9.48it/s]Computing features:   6%|▌         | 60/1000 [00:06<01:35,  9.84it/s]Computing features:   7%|▋         | 66/1000 [00:06<01:34,  9.86it/s]Computing features:   7%|▋         | 72/1000 [00:07<01:34,  9.86it/s]Computing features:   8%|▊         | 78/1000 [00:07<01:31, 10.03it/s]Computing features:   9%|▊         | 86/1000 [00:08<01:28, 10.35it/s]Computing features:   9%|▉         | 92/1000 [00:09<01:27, 10.38it/s]Computing features:  10%|▉         | 98/1000 [00:09<01:26, 10.37it/s]Computing features:  10%|█         | 104/1000 [00:10<01:27, 10.29it/s]Computing features:  11%|█         | 110/1000 [00:10<01:27, 10.21it/s]Computing features:  12%|█▏        | 116/1000 [00:11<01:26, 10.20it/s]Computing features:  12%|█▏        | 122/1000 [00:12<01:26, 10.12it/s]Computing features:  13%|█▎        | 129/1000 [00:12<01:25, 10.22it/s]Computing features:  14%|█▎        | 136/1000 [00:13<01:23, 10.34it/s]Computing features:  14%|█▍        | 142/1000 [00:13<01:22, 10.39it/s]Computing features:  15%|█▍        | 148/1000 [00:14<01:21, 10.42it/s]Computing features:  15%|█▌        | 154/1000 [00:14<01:20, 10.50it/s]Computing features:  16%|█▌        | 161/1000 [00:15<01:19, 10.61it/s]Computing features:  17%|█▋        | 167/1000 [00:16<01:19, 10.46it/s]Computing features:  17%|█▋        | 173/1000 [00:16<01:18, 10.51it/s]Computing features:  18%|█▊        | 180/1000 [00:17<01:16, 10.65it/s]Computing features:  19%|█▊        | 186/1000 [00:17<01:17, 10.51it/s]Computing features:  19%|█▉        | 192/1000 [00:18<01:16, 10.56it/s]Computing features:  20%|█▉        | 198/1000 [00:19<01:16, 10.47it/s]Computing features:  20%|██        | 204/1000 [00:19<01:16, 10.36it/s]Computing features:  21%|██        | 210/1000 [00:20<01:16, 10.32it/s]Computing features:  22%|██▏       | 216/1000 [00:21<01:16, 10.26it/s]Computing features:  22%|██▏       | 222/1000 [00:21<01:15, 10.30it/s]Computing features:  23%|██▎       | 228/1000 [00:22<01:14, 10.36it/s]Computing features:  24%|██▎       | 235/1000 [00:22<01:12, 10.51it/s]Computing features:  24%|██▍       | 242/1000 [00:23<01:11, 10.64it/s]Computing features:  25%|██▌       | 250/1000 [00:23<01:09, 10.85it/s]Computing features:  26%|██▌       | 256/1000 [00:24<01:08, 10.87it/s]Computing features:  26%|██▌       | 262/1000 [00:24<01:07, 10.91it/s]Computing features:  27%|██▋       | 268/1000 [00:25<01:07, 10.89it/s]Computing features:  27%|██▋       | 274/1000 [00:25<01:06, 10.94it/s]Computing features:  28%|██▊       | 280/1000 [00:26<01:05, 10.96it/s]Computing features:  29%|██▊       | 286/1000 [00:27<01:05, 10.89it/s]Computing features:  29%|██▉       | 292/1000 [00:27<01:05, 10.76it/s]Computing features:  30%|██▉       | 298/1000 [00:28<01:05, 10.71it/s]Computing features:  30%|███       | 304/1000 [00:28<01:05, 10.68it/s]Computing features:  31%|███       | 310/1000 [00:29<01:04, 10.68it/s]Computing features:  32%|███▏      | 316/1000 [00:30<01:03, 10.70it/s]Computing features:  32%|███▏      | 323/1000 [00:30<01:02, 10.80it/s]Computing features:  33%|███▎      | 329/1000 [00:31<01:02, 10.80it/s]Computing features:  34%|███▎      | 335/1000 [00:31<01:01, 10.83it/s]Computing features:  34%|███▍      | 341/1000 [00:32<01:01, 10.65it/s]Computing features:  35%|███▍      | 347/1000 [00:33<01:03, 10.24it/s]Computing features:  35%|███▌      | 353/1000 [00:34<01:03, 10.18it/s]Computing features:  36%|███▌      | 362/1000 [00:34<01:01, 10.45it/s]Computing features:  37%|███▋      | 369/1000 [00:35<00:59, 10.60it/s]Computing features:  38%|███▊      | 377/1000 [00:35<00:57, 10.83it/s]Computing features:  38%|███▊      | 385/1000 [00:36<00:55, 11.04it/s]Computing features:  39%|███▉      | 394/1000 [00:36<00:53, 11.34it/s]Computing features:  40%|████      | 405/1000 [00:37<00:50, 11.78it/s]Computing features:  41%|████▏     | 414/1000 [00:37<00:48, 12.02it/s]Computing features:  42%|████▏     | 424/1000 [00:38<00:46, 12.35it/s]Computing features:  44%|████▎     | 435/1000 [00:38<00:44, 12.77it/s]Computing features:  45%|████▍     | 446/1000 [00:39<00:42, 13.11it/s]Computing features:  46%|████▌     | 455/1000 [00:39<00:41, 13.29it/s]Computing features:  46%|████▋     | 465/1000 [00:40<00:39, 13.58it/s]Computing features:  47%|████▋     | 473/1000 [00:40<00:38, 13.67it/s]Computing features:  48%|████▊     | 481/1000 [00:41<00:37, 13.75it/s]Computing features:  49%|████▉     | 489/1000 [00:42<00:37, 13.48it/s]Computing features:  50%|████▉     | 496/1000 [00:42<00:37, 13.38it/s]Computing features:  50%|█████     | 503/1000 [00:43<00:37, 13.37it/s]Computing features:  51%|█████     | 510/1000 [00:44<00:37, 13.24it/s]Computing features:  52%|█████▏    | 517/1000 [00:44<00:36, 13.26it/s]Computing features:  52%|█████▎    | 525/1000 [00:45<00:35, 13.28it/s]Computing features:  53%|█████▎    | 532/1000 [00:45<00:35, 13.08it/s]Computing features:  54%|█████▍    | 539/1000 [00:46<00:35, 13.03it/s]Computing features:  55%|█████▍    | 546/1000 [00:46<00:34, 13.00it/s]Computing features:  55%|█████▌    | 553/1000 [00:47<00:34, 13.04it/s]Computing features:  56%|█████▌    | 560/1000 [00:47<00:33, 13.04it/s]Computing features:  57%|█████▋    | 567/1000 [00:48<00:33, 12.91it/s]Computing features:  57%|█████▋    | 574/1000 [00:49<00:33, 12.90it/s]Computing features:  58%|█████▊    | 585/1000 [00:49<00:31, 13.24it/s]Computing features:  59%|█████▉    | 593/1000 [00:50<00:30, 13.33it/s]Computing features:  60%|██████    | 600/1000 [00:50<00:30, 13.33it/s]Computing features:  61%|██████    | 607/1000 [00:51<00:30, 13.04it/s]Computing features:  61%|██████▏   | 614/1000 [00:52<00:30, 12.80it/s]Computing features:  62%|██████▏   | 621/1000 [00:53<00:31, 12.18it/s]Computing features:  63%|██████▎   | 628/1000 [00:54<00:31, 11.63it/s]Computing features:  64%|██████▎   | 635/1000 [00:55<00:32, 11.30it/s]Computing features:  64%|██████▍   | 642/1000 [00:56<00:32, 10.88it/s]Computing features:  65%|██████▍   | 648/1000 [00:57<00:32, 10.70it/s]Computing features:  65%|██████▌   | 654/1000 [00:58<00:33, 10.35it/s]Computing features:  66%|██████▌   | 660/1000 [00:59<00:33, 10.18it/s]Computing features:  67%|██████▋   | 666/1000 [01:00<00:33, 10.07it/s]Computing features:  67%|██████▋   | 672/1000 [01:00<00:32, 10.05it/s]Computing features:  68%|██████▊   | 678/1000 [01:01<00:32,  9.89it/s]Computing features:  68%|██████▊   | 684/1000 [01:02<00:32,  9.75it/s]Computing features:  69%|██████▉   | 690/1000 [01:03<00:32,  9.49it/s]Computing features:  70%|██████▉   | 696/1000 [01:04<00:32,  9.36it/s]Computing features:  70%|███████   | 702/1000 [01:04<00:31,  9.38it/s]Computing features:  71%|███████   | 708/1000 [01:05<00:31,  9.39it/s]Computing features:  71%|███████▏  | 714/1000 [01:06<00:30,  9.38it/s]Computing features:  72%|███████▏  | 720/1000 [01:06<00:29,  9.46it/s]Computing features:  73%|███████▎  | 726/1000 [01:07<00:29,  9.44it/s]Computing features:  73%|███████▎  | 732/1000 [01:07<00:28,  9.38it/s]Computing features:  74%|███████▍  | 738/1000 [01:08<00:27,  9.44it/s]Computing features:  74%|███████▍  | 744/1000 [01:09<00:27,  9.44it/s]Computing features:  75%|███████▌  | 751/1000 [01:09<00:26,  9.57it/s]Computing features:  76%|███████▌  | 757/1000 [01:10<00:25,  9.58it/s]Computing features:  76%|███████▋  | 763/1000 [01:10<00:24,  9.63it/s]Computing features:  77%|███████▋  | 769/1000 [01:11<00:23,  9.68it/s]Computing features:  78%|███████▊  | 776/1000 [01:11<00:22,  9.78it/s]Computing features:  78%|███████▊  | 782/1000 [01:12<00:22,  9.77it/s]Computing features:  79%|███████▉  | 788/1000 [01:13<00:21,  9.81it/s]Computing features:  79%|███████▉  | 794/1000 [01:13<00:21,  9.76it/s]Computing features:  80%|████████  | 800/1000 [01:14<00:20,  9.84it/s]Computing features:  81%|████████  | 806/1000 [01:15<00:19,  9.81it/s]Computing features:  81%|████████  | 812/1000 [01:15<00:19,  9.74it/s]Computing features:  82%|████████▏ | 818/1000 [01:16<00:18,  9.77it/s]Computing features:  83%|████████▎ | 827/1000 [01:16<00:17, 10.09it/s]Computing features:  83%|████████▎ | 833/1000 [01:17<00:16, 10.07it/s]Computing features:  84%|████████▍ | 839/1000 [01:18<00:16, 10.04it/s]Computing features:  85%|████████▍ | 846/1000 [01:18<00:15, 10.14it/s]Computing features:  85%|████████▌ | 852/1000 [01:19<00:14, 10.13it/s]Computing features:  86%|████████▌ | 858/1000 [01:19<00:13, 10.17it/s]Computing features:  86%|████████▋ | 864/1000 [01:20<00:13, 10.22it/s]Computing features:  87%|████████▋ | 870/1000 [01:20<00:12, 10.17it/s]Computing features:  88%|████████▊ | 876/1000 [01:21<00:12, 10.17it/s]Computing features:  88%|████████▊ | 882/1000 [01:22<00:11, 10.18it/s]Computing features:  89%|████████▉ | 889/1000 [01:22<00:10, 10.27it/s]Computing features:  90%|████████▉ | 895/1000 [01:23<00:10, 10.24it/s]Computing features:  90%|█████████ | 901/1000 [01:23<00:09, 10.25it/s]Computing features:  91%|█████████ | 907/1000 [01:24<00:09, 10.25it/s]Computing features:  91%|█████████▏| 913/1000 [01:25<00:08, 10.25it/s]Computing features:  92%|█████████▏| 921/1000 [01:25<00:07, 10.44it/s]Computing features:  93%|█████████▎| 927/1000 [01:26<00:06, 10.48it/s]Computing features:  93%|█████████▎| 934/1000 [01:26<00:06, 10.63it/s]Computing features:  94%|█████████▍| 941/1000 [01:27<00:05, 10.73it/s]Computing features:  95%|█████████▍| 947/1000 [01:27<00:04, 10.74it/s]Computing features:  95%|█████████▌| 954/1000 [01:28<00:04, 10.86it/s]Computing features:  96%|█████████▌| 960/1000 [01:28<00:03, 10.90it/s]Computing features:  97%|█████████▋| 966/1000 [01:29<00:03, 10.82it/s]Computing features:  97%|█████████▋| 972/1000 [01:30<00:02, 10.74it/s]Computing features:  98%|█████████▊| 978/1000 [01:30<00:02, 10.69it/s]Computing features:  98%|█████████▊| 984/1000 [01:31<00:01, 10.57it/s]Computing features:  99%|█████████▉| 990/1000 [01:31<00:00, 10.56it/s]Computing features: 100%|█████████▉| 996/1000 [01:32<00:00, 10.61it/s]Computing features: 100%|██████████| 1000/1000 [01:32<00:00, 10.77it/s]
19:05:11 - INFO - Built flat FAISS index: 1000 images, dimension 216
19:05:11 - INFO - Saving FAISS cache...
19:05:11 - INFO - FAISS cache saved successfully
19:05:11 - INFO - Video aspect ratio: 1.778
19:05:11 - INFO - Processing 599 frames...
Matching frames:   0%|          | 0/599 [00:00<?, ?it/s]Matching frames:   1%|          | 5/599 [00:00<01:00,  9.90it/s]Matching frames:   4%|▍         | 23/599 [00:01<00:24, 23.19it/s]Matching frames:   6%|▌         | 37/599 [00:01<00:23, 24.43it/s]Matching frames:   9%|▊         | 51/599 [00:02<00:22, 24.16it/s]Matching frames:  11%|█         | 65/599 [00:02<00:21, 24.37it/s]Matching frames:  13%|█▎        | 79/599 [00:03<00:21, 24.14it/s]Matching frames:  16%|█▌        | 93/599 [00:03<00:20, 24.56it/s]Matching frames:  18%|█▊        | 106/599 [00:04<00:21, 22.97it/s]Matching frames:  20%|█▉        | 118/599 [00:05<00:21, 22.13it/s]Matching frames:  22%|██▏       | 130/599 [00:05<00:21, 21.95it/s]Matching frames:  24%|██▎       | 142/599 [00:06<00:20, 22.07it/s]Matching frames:  26%|██▌       | 154/599 [00:07<00:21, 20.75it/s]Matching frames:  28%|██▊       | 167/599 [00:07<00:20, 21.12it/s]Matching frames:  31%|███       | 185/599 [00:08<00:18, 22.32it/s]Matching frames:  33%|███▎      | 199/599 [00:08<00:17, 22.50it/s]Matching frames:  35%|███▌      | 211/599 [00:09<00:18, 20.82it/s]Matching frames:  37%|███▋      | 223/599 [00:10<00:18, 20.83it/s]Matching frames:  40%|███▉      | 237/599 [00:11<00:17, 21.22it/s]Matching frames:  42%|████▏     | 251/599 [00:11<00:16, 21.40it/s]Matching frames:  45%|████▍     | 267/599 [00:12<00:15, 22.00it/s]Matching frames:  48%|████▊     | 286/599 [00:12<00:13, 23.00it/s]Matching frames:  50%|████▉     | 299/599 [00:13<00:12, 23.11it/s]Matching frames:  52%|█████▏    | 312/599 [00:13<00:12, 23.19it/s]Matching frames:  54%|█████▍    | 325/599 [00:14<00:12, 22.20it/s]Matching frames:  56%|█████▋    | 337/599 [00:15<00:12, 21.53it/s]Matching frames:  58%|█████▊    | 349/599 [00:16<00:11, 21.18it/s]Matching frames:  60%|██████    | 361/599 [00:16<00:11, 20.76it/s]Matching frames:  63%|██████▎   | 377/599 [00:17<00:10, 21.12it/s]Matching frames:  65%|██████▍   | 389/599 [00:18<00:10, 20.93it/s]Matching frames:  67%|██████▋   | 404/599 [00:18<00:09, 21.36it/s]Matching frames:  71%|███████   | 423/599 [00:19<00:07, 22.15it/s]Matching frames:  73%|███████▎  | 439/599 [00:19<00:07, 22.32it/s]Matching frames:  75%|███████▌  | 451/599 [00:20<00:06, 21.47it/s]Matching frames:  77%|███████▋  | 463/599 [00:21<00:06, 21.10it/s]Matching frames:  79%|███████▉  | 475/599 [00:22<00:05, 21.02it/s]Matching frames:  81%|████████▏ | 487/599 [00:22<00:05, 20.84it/s]Matching frames:  83%|████████▎ | 499/599 [00:23<00:04, 20.39it/s]Matching frames:  85%|████████▌ | 510/599 [00:24<00:04, 20.32it/s]Matching frames:  87%|████████▋ | 521/599 [00:25<00:04, 19.46it/s]Matching frames:  89%|████████▉ | 532/599 [00:25<00:03, 19.40it/s]Matching frames:  91%|█████████ | 543/599 [00:26<00:02, 18.85it/s]Matching frames:  92%|█████████▏| 554/599 [00:27<00:02, 18.91it/s]Matching frames:  94%|█████████▍| 565/599 [00:27<00:01, 18.96it/s]Matching frames:  97%|█████████▋| 579/599 [00:28<00:01, 19.13it/s]Matching frames:  99%|█████████▉| 595/599 [00:29<00:00, 19.58it/s]Matching frames: 100%|██████████| 599/599 [00:29<00:00, 20.40it/s]
19:05:41 - INFO - Results saved to output_avg_3x3/results.json
19:05:41 - INFO - Verification: All frames have valid selections
19:05:42 - INFO - Generating output...
19:05:42 - INFO - Output FPS: 25.0 (input: 59.94)
Generating output:   0%|          | 0/300 [00:00<?, ?it/s]Generating output:   2%|▏         | 6/300 [00:00<00:26, 11.09it/s]Generating output:   4%|▍         | 12/300 [00:01<00:25, 11.49it/s]Generating output:   6%|▋         | 19/300 [00:01<00:23, 12.16it/s]Generating output:   9%|▊         | 26/300 [00:02<00:23, 11.73it/s]Generating output:  11%|█         | 32/300 [00:02<00:23, 11.59it/s]Generating output:  13%|█▎        | 38/300 [00:03<00:22, 11.62it/s]Generating output:  15%|█▍        | 44/300 [00:03<00:22, 11.59it/s]Generating output:  17%|█▋        | 50/300 [00:04<00:21, 11.59it/s]Generating output:  19%|█▊        | 56/300 [00:04<00:21, 11.46it/s]Generating output:  21%|██        | 62/300 [00:05<00:21, 11.28it/s]Generating output:  23%|██▎       | 69/300 [00:05<00:20, 11.51it/s]Generating output:  25%|██▌       | 76/300 [00:06<00:19, 11.51it/s]Generating output:  27%|██▋       | 82/300 [00:07<00:18, 11.49it/s]Generating output:  30%|██▉       | 89/300 [00:07<00:18, 11.63it/s]Generating output:  32%|███▏      | 95/300 [00:08<00:17, 11.59it/s]Generating output:  34%|███▎      | 101/300 [00:08<00:17, 11.60it/s]Generating output:  36%|███▌      | 107/300 [00:09<00:16, 11.57it/s]Generating output:  38%|███▊      | 113/300 [00:09<00:16, 11.53it/s]Generating output:  40%|███▉      | 119/300 [00:10<00:15, 11.53it/s]Generating output:  42%|████▏     | 125/300 [00:10<00:15, 11.47it/s]Generating output:  44%|████▎     | 131/300 [00:11<00:14, 11.41it/s]Generating output:  46%|████▌     | 137/300 [00:11<00:14, 11.40it/s]Generating output:  48%|████▊     | 143/300 [00:12<00:13, 11.37it/s]Generating output:  50%|█████     | 150/300 [00:13<00:13, 11.46it/s]Generating output:  52%|█████▏    | 156/300 [00:13<00:12, 11.29it/s]Generating output:  54%|█████▍    | 163/300 [00:14<00:12, 11.29it/s]Generating output:  56%|█████▋    | 169/300 [00:14<00:11, 11.23it/s]Generating output:  59%|█████▊    | 176/300 [00:15<00:10, 11.33it/s]Generating output:  61%|██████▏   | 184/300 [00:15<00:10, 11.56it/s]Generating output:  64%|██████▍   | 192/300 [00:16<00:09, 11.80it/s]Generating output:  67%|██████▋   | 201/300 [00:17<00:08, 12.09it/s]Generating output:  70%|███████   | 210/300 [00:17<00:07, 12.42it/s]Generating output:  73%|███████▎  | 219/300 [00:18<00:06, 12.67it/s]Generating output:  75%|███████▌  | 226/300 [00:18<00:05, 12.71it/s]Generating output:  78%|███████▊  | 234/300 [00:19<00:05, 12.81it/s]Generating output:  80%|████████  | 241/300 [00:19<00:04, 12.85it/s]Generating output:  83%|████████▎ | 249/300 [00:20<00:03, 13.00it/s]Generating output:  86%|████████▌ | 257/300 [00:20<00:03, 13.10it/s]Generating output:  88%|████████▊ | 264/300 [00:21<00:02, 13.06it/s]Generating output:  90%|█████████ | 271/300 [00:21<00:02, 13.10it/s]Generating output:  93%|█████████▎| 278/300 [00:22<00:01, 13.08it/s]Generating output:  95%|█████████▌| 286/300 [00:22<00:01, 13.23it/s]Generating output:  98%|█████████▊| 294/300 [00:23<00:00, 13.37it/s]Generating output: 100%|██████████| 300/300 [00:23<00:00, 12.63it/s]
19:06:06 - INFO - Output video saved to: output_avg_3x3/Winter Cycling： Vantaa, Finland - 4K 60fps_matched.mp4
19:06:06 - INFO - Output images saved to: output_avg_3x3/matched_frames

Done!

real	4m3,723s
user	10m34,778s
sys	0m45,193s

3/5: Avg + global (1x1, fastest)
19:06:07 - INFO - Video: /home/birgit/Downloads/Winter Cycling： Vantaa, Finland - 4K 60fps.mp4
19:06:07 - INFO - Image folder: /home/birgit/fiftyone/open-images-v7/train/data
19:06:07 - INFO - Output directory: output_avg_global
19:06:07 - INFO - Search depth: 10
19:06:07 - INFO - Similarity threshold: 0.0
19:06:07 - INFO - No repeat: True
19:06:07 - INFO - Checkpoint batch size: 10
19:06:07 - INFO - Feature method: mobilenet
19:06:07 - INFO - Demo mode: ON (max 10s video, 1000 images)
19:06:07 - INFO - Weights - Edge: 0.60, Texture: 0.20, Color: 0.20
19:06:08 - INFO - FPS override: 25.0 (input: 59.94, skip interval: 2)
19:06:08 - INFO - Demo mode: Processing first 10 seconds (599 frames) out of 123084
19:06:08 - INFO - Scanning image folder...
19:06:29 - INFO - Sorting 467000 image paths...
19:06:48 - INFO - Demo mode: Using first 1000 images out of 467000
19:06:51 - INFO - Found 1000 images in folder
19:06:51 - INFO - Preparing FAISS index...
19:06:51 - INFO - Cache files not found, will rebuild
19:06:51 - INFO - Building FAISS index for 1000 images...
19:06:51 - INFO -   Comparison size: 256px
19:06:51 - INFO -   Using single-process mode (ONNX Runtime handles threading)
Computing features:   0%|          | 0/1000 [00:00<?, ?it/s]Computing features:   1%|          | 6/1000 [00:00<01:29, 11.12it/s]Computing features:   1%|          | 12/1000 [00:01<01:37, 10.15it/s]Computing features:   2%|▏         | 19/1000 [00:01<01:29, 10.95it/s]Computing features:   2%|▎         | 25/1000 [00:02<01:32, 10.52it/s]Computing features:   3%|▎         | 31/1000 [00:02<01:30, 10.67it/s]Computing features:   4%|▎         | 37/1000 [00:03<01:28, 10.82it/s]Computing features:   4%|▍         | 43/1000 [00:03<01:27, 10.99it/s]Computing features:   5%|▌         | 50/1000 [00:04<01:23, 11.31it/s]Computing features:   6%|▌         | 57/1000 [00:04<01:21, 11.60it/s]Computing features:   6%|▋         | 63/1000 [00:05<01:22, 11.30it/s]Computing features:   7%|▋         | 69/1000 [00:06<01:23, 11.15it/s]Computing features:   8%|▊         | 75/1000 [00:06<01:23, 11.03it/s]Computing features:   8%|▊         | 82/1000 [00:07<01:21, 11.25it/s]Computing features:   9%|▉         | 88/1000 [00:07<01:22, 11.04it/s]Computing features:   9%|▉         | 94/1000 [00:08<01:22, 10.98it/s]Computing features:  10%|█         | 101/1000 [00:09<01:21, 11.07it/s]Computing features:  11%|█         | 107/1000 [00:09<01:21, 10.96it/s]Computing features:  11%|█▏        | 113/1000 [00:10<01:20, 10.96it/s]Computing features:  12%|█▏        | 119/1000 [00:10<01:20, 10.93it/s]Computing features:  13%|█▎        | 126/1000 [00:11<01:19, 11.03it/s]Computing features:  13%|█▎        | 132/1000 [00:12<01:19, 10.88it/s]Computing features:  14%|█▍        | 138/1000 [00:12<01:19, 10.90it/s]Computing features:  14%|█▍        | 144/1000 [00:13<01:19, 10.73it/s]Computing features:  15%|█▌        | 150/1000 [00:13<01:19, 10.73it/s]Computing features:  16%|█▌        | 156/1000 [00:14<01:18, 10.70it/s]Computing features:  16%|█▌        | 162/1000 [00:14<01:18, 10.74it/s]Computing features:  17%|█▋        | 168/1000 [00:15<01:17, 10.76it/s]Computing features:  18%|█▊        | 175/1000 [00:15<01:15, 10.94it/s]Computing features:  18%|█▊        | 181/1000 [00:16<01:14, 10.96it/s]Computing features:  19%|█▊        | 187/1000 [00:17<01:14, 10.90it/s]Computing features:  19%|█▉        | 193/1000 [00:17<01:14, 10.81it/s]Computing features:  20%|█▉        | 199/1000 [00:18<01:13, 10.85it/s]Computing features:  21%|██        | 206/1000 [00:18<01:12, 10.92it/s]Computing features:  21%|██        | 212/1000 [00:19<01:12, 10.84it/s]Computing features:  22%|██▏       | 220/1000 [00:20<01:10, 11.04it/s]Computing features:  23%|██▎       | 226/1000 [00:20<01:10, 11.04it/s]Computing features:  23%|██▎       | 232/1000 [00:21<01:10, 10.97it/s]Computing features:  24%|██▍       | 238/1000 [00:21<01:09, 10.96it/s]Computing features:  24%|██▍       | 245/1000 [00:22<01:08, 11.05it/s]Computing features:  25%|██▌       | 251/1000 [00:22<01:07, 11.08it/s]Computing features:  26%|██▌       | 259/1000 [00:23<01:05, 11.28it/s]Computing features:  27%|██▋       | 266/1000 [00:23<01:05, 11.29it/s]Computing features:  27%|██▋       | 272/1000 [00:24<01:04, 11.20it/s]Computing features:  28%|██▊       | 278/1000 [00:25<01:05, 11.07it/s]Computing features:  28%|██▊       | 284/1000 [00:25<01:05, 10.97it/s]Computing features:  29%|██▉       | 290/1000 [00:26<01:05, 10.77it/s]Computing features:  30%|██▉       | 298/1000 [00:27<01:03, 10.99it/s]Computing features:  30%|███       | 304/1000 [00:27<01:03, 10.93it/s]Computing features:  31%|███       | 311/1000 [00:28<01:02, 11.03it/s]Computing features:  32%|███▏      | 318/1000 [00:28<01:01, 11.09it/s]Computing features:  32%|███▏      | 324/1000 [00:29<01:01, 10.99it/s]Computing features:  33%|███▎      | 330/1000 [00:30<01:01, 10.81it/s]Computing features:  34%|███▎      | 336/1000 [00:30<01:02, 10.62it/s]Computing features:  34%|███▍      | 344/1000 [00:31<01:00, 10.85it/s]Computing features:  36%|███▌      | 355/1000 [00:32<00:56, 11.34it/s]Computing features:  36%|███▋      | 364/1000 [00:32<00:54, 11.64it/s]Computing features:  38%|███▊      | 375/1000 [00:33<00:51, 12.07it/s]Computing features:  38%|███▊      | 383/1000 [00:33<00:50, 12.21it/s]Computing features:  39%|███▉      | 393/1000 [00:34<00:48, 12.56it/s]Computing features:  40%|████      | 402/1000 [00:34<00:46, 12.74it/s]Computing features:  41%|████      | 411/1000 [00:35<00:45, 12.97it/s]Computing features:  42%|████▏     | 420/1000 [00:35<00:43, 13.19it/s]Computing features:  43%|████▎     | 430/1000 [00:36<00:42, 13.48it/s]Computing features:  44%|████▍     | 440/1000 [00:36<00:40, 13.73it/s]Computing features:  45%|████▌     | 450/1000 [00:37<00:39, 14.00it/s]Computing features:  46%|████▌     | 460/1000 [00:37<00:37, 14.23it/s]Computing features:  47%|████▋     | 468/1000 [00:38<00:37, 14.16it/s]Computing features:  48%|████▊     | 476/1000 [00:38<00:37, 14.09it/s]Computing features:  48%|████▊     | 484/1000 [00:39<00:36, 14.03it/s]Computing features:  49%|████▉     | 492/1000 [00:40<00:36, 14.08it/s]Computing features:  50%|█████     | 500/1000 [00:40<00:36, 13.77it/s]Computing features:  51%|█████     | 508/1000 [00:41<00:35, 13.73it/s]Computing features:  52%|█████▏    | 516/1000 [00:42<00:35, 13.48it/s]Computing features:  52%|█████▏    | 523/1000 [00:43<00:36, 13.19it/s]Computing features:  53%|█████▎    | 530/1000 [00:43<00:36, 13.02it/s]Computing features:  54%|█████▍    | 539/1000 [00:44<00:35, 13.15it/s]Computing features:  55%|█████▍    | 547/1000 [00:44<00:34, 13.23it/s]Computing features:  56%|█████▌    | 555/1000 [00:45<00:33, 13.33it/s]Computing features:  56%|█████▌    | 562/1000 [00:46<00:33, 13.24it/s]Computing features:  57%|█████▋    | 569/1000 [00:46<00:32, 13.18it/s]Computing features:  58%|█████▊    | 576/1000 [00:47<00:32, 13.13it/s]Computing features:  58%|█████▊    | 584/1000 [00:47<00:31, 13.12it/s]Computing features:  59%|█████▉    | 593/1000 [00:48<00:30, 13.25it/s]Computing features:  60%|██████    | 600/1000 [00:49<00:30, 13.04it/s]Computing features:  61%|██████    | 607/1000 [00:49<00:30, 12.72it/s]Computing features:  61%|██████▏   | 614/1000 [00:50<00:30, 12.47it/s]Computing features:  62%|██████▏   | 621/1000 [00:51<00:31, 12.11it/s]Computing features:  63%|██████▎   | 628/1000 [00:52<00:31, 11.72it/s]Computing features:  64%|██████▎   | 635/1000 [00:53<00:31, 11.45it/s]Computing features:  64%|██████▍   | 642/1000 [00:54<00:31, 11.25it/s]Computing features:  65%|██████▍   | 648/1000 [00:55<00:31, 11.14it/s]Computing features:  65%|██████▌   | 654/1000 [00:55<00:31, 10.99it/s]Computing features:  66%|██████▌   | 660/1000 [00:56<00:31, 10.80it/s]Computing features:  67%|██████▋   | 666/1000 [00:57<00:30, 10.78it/s]Computing features:  67%|██████▋   | 672/1000 [00:57<00:30, 10.65it/s]Computing features:  68%|██████▊   | 678/1000 [00:58<00:30, 10.39it/s]Computing features:  68%|██████▊   | 684/1000 [00:59<00:30, 10.21it/s]Computing features:  69%|██████▉   | 690/1000 [01:00<00:30, 10.06it/s]Computing features:  70%|██████▉   | 696/1000 [01:01<00:30,  9.98it/s]Computing features:  70%|███████   | 702/1000 [01:01<00:30,  9.83it/s]Computing features:  71%|███████   | 708/1000 [01:02<00:29,  9.78it/s]Computing features:  72%|███████▏  | 715/1000 [01:03<00:28,  9.86it/s]Computing features:  72%|███████▏  | 722/1000 [01:03<00:27,  9.94it/s]Computing features:  73%|███████▎  | 728/1000 [01:04<00:27,  9.98it/s]Computing features:  73%|███████▎  | 734/1000 [01:04<00:26, 10.02it/s]Computing features:  74%|███████▍  | 740/1000 [01:05<00:25, 10.04it/s]Computing features:  75%|███████▍  | 746/1000 [01:06<00:25, 10.07it/s]Computing features:  75%|███████▌  | 754/1000 [01:06<00:24, 10.25it/s]Computing features:  76%|███████▌  | 760/1000 [01:07<00:23, 10.29it/s]Computing features:  77%|███████▋  | 766/1000 [01:07<00:22, 10.27it/s]Computing features:  77%|███████▋  | 772/1000 [01:08<00:22, 10.31it/s]Computing features:  78%|███████▊  | 778/1000 [01:08<00:21, 10.33it/s]Computing features:  78%|███████▊  | 784/1000 [01:09<00:21, 10.28it/s]Computing features:  79%|███████▉  | 791/1000 [01:10<00:20, 10.35it/s]Computing features:  80%|███████▉  | 797/1000 [01:10<00:19, 10.38it/s]Computing features:  80%|████████  | 803/1000 [01:11<00:18, 10.40it/s]Computing features:  81%|████████  | 809/1000 [01:11<00:18, 10.42it/s]Computing features:  82%|████████▏ | 815/1000 [01:12<00:17, 10.43it/s]Computing features:  82%|████████▏ | 822/1000 [01:12<00:16, 10.52it/s]Computing features:  83%|████████▎ | 829/1000 [01:13<00:16, 10.63it/s]Computing features:  84%|████████▎ | 835/1000 [01:13<00:15, 10.60it/s]Computing features:  84%|████████▍ | 841/1000 [01:14<00:15, 10.59it/s]Computing features:  85%|████████▍ | 847/1000 [01:15<00:14, 10.47it/s]Computing features:  85%|████████▌ | 853/1000 [01:15<00:14, 10.46it/s]Computing features:  86%|████████▌ | 860/1000 [01:16<00:13, 10.59it/s]Computing features:  87%|████████▋ | 866/1000 [01:16<00:12, 10.62it/s]Computing features:  87%|████████▋ | 872/1000 [01:17<00:12, 10.53it/s]Computing features:  88%|████████▊ | 878/1000 [01:18<00:11, 10.45it/s]Computing features:  88%|████████▊ | 884/1000 [01:18<00:11, 10.48it/s]Computing features:  89%|████████▉ | 890/1000 [01:19<00:10, 10.44it/s]Computing features:  90%|████████▉ | 897/1000 [01:19<00:09, 10.49it/s]Computing features:  90%|█████████ | 903/1000 [01:20<00:09, 10.34it/s]Computing features:  91%|█████████ | 909/1000 [01:21<00:08, 10.40it/s]Computing features:  92%|█████████▏| 915/1000 [01:21<00:08, 10.40it/s]Computing features:  92%|█████████▏| 921/1000 [01:22<00:07, 10.34it/s]Computing features:  93%|█████████▎| 927/1000 [01:22<00:07, 10.38it/s]Computing features:  93%|█████████▎| 933/1000 [01:23<00:06, 10.38it/s]Computing features:  94%|█████████▍| 939/1000 [01:24<00:05, 10.40it/s]Computing features:  94%|█████████▍| 945/1000 [01:24<00:05, 10.45it/s]Computing features:  95%|█████████▌| 952/1000 [01:25<00:04, 10.52it/s]Computing features:  96%|█████████▌| 959/1000 [01:25<00:03, 10.61it/s]Computing features:  96%|█████████▋| 965/1000 [01:26<00:03, 10.64it/s]Computing features:  97%|█████████▋| 971/1000 [01:27<00:02, 10.52it/s]Computing features:  98%|█████████▊| 977/1000 [01:27<00:02, 10.51it/s]Computing features:  98%|█████████▊| 983/1000 [01:28<00:01, 10.51it/s]Computing features:  99%|█████████▉| 989/1000 [01:28<00:01, 10.46it/s]Computing features: 100%|█████████▉| 996/1000 [01:29<00:00, 10.57it/s]Computing features: 100%|██████████| 1000/1000 [01:29<00:00, 11.15it/s]
19:08:20 - INFO - Built flat FAISS index: 1000 images, dimension 24
19:08:20 - INFO - Saving FAISS cache...
19:08:20 - INFO - FAISS cache saved successfully
19:08:20 - INFO - Video aspect ratio: 1.778
19:08:20 - INFO - Processing 599 frames...
Matching frames:   0%|          | 0/599 [00:00<?, ?it/s]Matching frames:   1%|          | 7/599 [00:00<00:44, 13.18it/s]Matching frames:   4%|▍         | 25/599 [00:01<00:23, 23.95it/s]Matching frames:   7%|▋         | 41/599 [00:01<00:21, 26.09it/s]Matching frames:   9%|▉         | 55/599 [00:02<00:20, 26.12it/s]Matching frames:  12%|█▏        | 71/599 [00:02<00:19, 27.33it/s]Matching frames:  15%|█▍        | 87/599 [00:03<00:18, 28.03it/s]Matching frames:  17%|█▋        | 102/599 [00:03<00:18, 26.94it/s]Matching frames:  20%|█▉        | 119/599 [00:04<00:17, 27.78it/s]Matching frames:  24%|██▍       | 143/599 [00:04<00:15, 30.20it/s]Matching frames:  27%|██▋       | 159/599 [00:05<00:15, 28.71it/s]Matching frames:  29%|██▉       | 174/599 [00:06<00:14, 28.46it/s]Matching frames:  32%|███▏      | 189/599 [00:06<00:14, 27.37it/s]Matching frames:  34%|███▍      | 204/599 [00:07<00:15, 26.33it/s]Matching frames:  37%|███▋      | 223/599 [00:08<00:13, 27.28it/s]Matching frames:  40%|███▉      | 238/599 [00:08<00:13, 27.33it/s]Matching frames:  42%|████▏     | 253/599 [00:09<00:12, 26.81it/s]Matching frames:  45%|████▍     | 267/599 [00:10<00:12, 26.16it/s]Matching frames:  47%|████▋     | 283/599 [00:10<00:12, 26.27it/s]Matching frames:  50%|████▉     | 297/599 [00:11<00:11, 25.29it/s]Matching frames:  52%|█████▏    | 311/599 [00:12<00:12, 23.66it/s]Matching frames:  54%|█████▍    | 324/599 [00:13<00:11, 23.40it/s]Matching frames:  56%|█████▋    | 337/599 [00:13<00:11, 23.03it/s]Matching frames:  58%|█████▊    | 350/599 [00:14<00:11, 22.59it/s]Matching frames:  60%|██████    | 362/599 [00:15<00:10, 21.79it/s]Matching frames:  63%|██████▎   | 375/599 [00:16<00:10, 21.83it/s]Matching frames:  65%|██████▍   | 387/599 [00:16<00:09, 21.53it/s]Matching frames:  67%|██████▋   | 401/599 [00:17<00:09, 21.62it/s]Matching frames:  70%|██████▉   | 419/599 [00:17<00:08, 22.30it/s]Matching frames:  73%|███████▎  | 439/599 [00:18<00:06, 23.13it/s]Matching frames:  76%|███████▌  | 456/599 [00:18<00:06, 23.66it/s]Matching frames:  79%|███████▉  | 475/599 [00:19<00:05, 24.30it/s]Matching frames:  82%|████████▏ | 492/599 [00:19<00:04, 24.74it/s]Matching frames:  85%|████████▍ | 509/599 [00:20<00:03, 25.17it/s]Matching frames:  87%|████████▋ | 523/599 [00:21<00:03, 24.77it/s]Matching frames:  90%|████████▉ | 537/599 [00:21<00:02, 24.58it/s]Matching frames:  92%|█████████▏| 550/599 [00:22<00:02, 24.47it/s]Matching frames:  94%|█████████▍| 563/599 [00:23<00:01, 24.35it/s]Matching frames:  96%|█████████▌| 576/599 [00:23<00:00, 24.36it/s]Matching frames:  98%|█████████▊| 589/599 [00:24<00:00, 23.87it/s]Matching frames: 100%|██████████| 599/599 [00:25<00:00, 23.83it/s]
19:08:46 - INFO - Results saved to output_avg_global/results.json
19:08:46 - INFO - Verification: All frames have valid selections
19:08:46 - INFO - Generating output...
19:08:47 - INFO - Output FPS: 25.0 (input: 59.94)
Generating output:   0%|          | 0/300 [00:00<?, ?it/s]Generating output:   2%|▏         | 6/300 [00:00<00:25, 11.33it/s]Generating output:   4%|▍         | 12/300 [00:01<00:25, 11.48it/s]Generating output:   6%|▌         | 18/300 [00:01<00:24, 11.43it/s]Generating output:   8%|▊         | 25/300 [00:02<00:23, 11.87it/s]Generating output:  10%|█         | 31/300 [00:02<00:23, 11.65it/s]Generating output:  12%|█▏        | 37/300 [00:03<00:22, 11.58it/s]Generating output:  15%|█▍        | 44/300 [00:03<00:21, 11.73it/s]Generating output:  17%|█▋        | 51/300 [00:04<00:20, 11.91it/s]Generating output:  19%|█▉        | 58/300 [00:04<00:19, 12.11it/s]Generating output:  22%|██▏       | 66/300 [00:05<00:18, 12.37it/s]Generating output:  24%|██▍       | 73/300 [00:05<00:18, 12.38it/s]Generating output:  27%|██▋       | 80/300 [00:06<00:17, 12.30it/s]Generating output:  29%|██▉       | 87/300 [00:07<00:17, 12.11it/s]Generating output:  31%|███▏      | 94/300 [00:07<00:17, 12.05it/s]Generating output:  34%|███▎      | 101/300 [00:08<00:16, 11.85it/s]Generating output:  36%|███▌      | 107/300 [00:08<00:16, 11.85it/s]Generating output:  38%|███▊      | 113/300 [00:09<00:15, 11.74it/s]Generating output:  40%|███▉      | 119/300 [00:10<00:15, 11.66it/s]Generating output:  42%|████▏     | 126/300 [00:10<00:14, 11.72it/s]Generating output:  44%|████▍     | 133/300 [00:11<00:14, 11.81it/s]Generating output:  46%|████▋     | 139/300 [00:11<00:13, 11.64it/s]Generating output:  48%|████▊     | 145/300 [00:12<00:13, 11.60it/s]Generating output:  51%|█████     | 152/300 [00:12<00:12, 11.71it/s]Generating output:  53%|█████▎    | 158/300 [00:13<00:12, 11.61it/s]Generating output:  55%|█████▍    | 164/300 [00:14<00:11, 11.50it/s]Generating output:  57%|█████▋    | 171/300 [00:14<00:11, 11.63it/s]Generating output:  59%|█████▉    | 177/300 [00:15<00:10, 11.58it/s]Generating output:  61%|██████    | 183/300 [00:15<00:10, 11.50it/s]Generating output:  63%|██████▎   | 189/300 [00:16<00:09, 11.43it/s]Generating output:  65%|██████▌   | 195/300 [00:16<00:09, 11.24it/s]Generating output:  67%|██████▋   | 201/300 [00:17<00:08, 11.21it/s]Generating output:  69%|██████▉   | 207/300 [00:18<00:08, 11.25it/s]Generating output:  72%|███████▏  | 215/300 [00:18<00:07, 11.47it/s]Generating output:  74%|███████▍  | 223/300 [00:19<00:06, 11.66it/s]Generating output:  77%|███████▋  | 232/300 [00:19<00:05, 11.95it/s]Generating output:  80%|████████  | 241/300 [00:20<00:04, 12.22it/s]Generating output:  83%|████████▎ | 248/300 [00:20<00:04, 12.26it/s]Generating output:  86%|████████▌ | 257/300 [00:21<00:03, 12.56it/s]Generating output:  89%|████████▊ | 266/300 [00:21<00:02, 12.76it/s]Generating output:  92%|█████████▏| 275/300 [00:22<00:01, 13.03it/s]Generating output:  94%|█████████▍| 283/300 [00:22<00:01, 13.17it/s]Generating output:  97%|█████████▋| 291/300 [00:23<00:00, 13.26it/s]Generating output: 100%|█████████▉| 299/300 [00:23<00:00, 13.33it/s]Generating output: 100%|██████████| 300/300 [00:23<00:00, 12.51it/s]
19:09:11 - INFO - Output video saved to: output_avg_global/Winter Cycling： Vantaa, Finland - 4K 60fps_matched.mp4
19:09:11 - INFO - Output images saved to: output_avg_global/matched_frames

Done!

real	3m5,020s
user	9m46,103s
sys	0m21,657s

4/5: GeM + 2x2 grid
19:09:12 - INFO - Video: /home/birgit/Downloads/Winter Cycling： Vantaa, Finland - 4K 60fps.mp4
19:09:12 - INFO - Image folder: /home/birgit/fiftyone/open-images-v7/train/data
19:09:12 - INFO - Output directory: output_gem_2x2
19:09:12 - INFO - Search depth: 10
19:09:12 - INFO - Similarity threshold: 0.0
19:09:12 - INFO - No repeat: True
19:09:12 - INFO - Checkpoint batch size: 10
19:09:12 - INFO - Feature method: mobilenet
19:09:12 - INFO - Demo mode: ON (max 10s video, 1000 images)
19:09:12 - INFO - Weights - Edge: 0.60, Texture: 0.20, Color: 0.20
19:09:13 - INFO - FPS override: 25.0 (input: 59.94, skip interval: 2)
19:09:13 - INFO - Demo mode: Processing first 10 seconds (599 frames) out of 123084
19:09:13 - INFO - Scanning image folder...
19:09:29 - INFO - Sorting 467000 image paths...
19:09:47 - INFO - Demo mode: Using first 1000 images out of 467000
19:09:49 - INFO - Found 1000 images in folder
19:09:49 - INFO - Preparing FAISS index...
19:09:49 - INFO - Cache files not found, will rebuild
19:09:49 - INFO - Building FAISS index for 1000 images...
19:09:49 - INFO -   Comparison size: 256px
19:09:49 - INFO -   Using single-process mode (ONNX Runtime handles threading)
Computing features:   0%|          | 0/1000 [00:00<?, ?it/s]Computing features:   1%|          | 6/1000 [00:00<01:36, 10.33it/s]Computing features:   1%|          | 12/1000 [00:01<01:32, 10.67it/s]Computing features:   2%|▏         | 19/1000 [00:01<01:24, 11.62it/s]Computing features:   3%|▎         | 26/1000 [00:02<01:21, 11.99it/s]Computing features:   3%|▎         | 33/1000 [00:02<01:26, 11.23it/s]Computing features:   4%|▍         | 39/1000 [00:03<01:27, 10.97it/s]Computing features:   4%|▍         | 45/1000 [00:04<01:29, 10.68it/s]Computing features:   5%|▌         | 51/1000 [00:04<01:28, 10.76it/s]Computing features:   6%|▌         | 58/1000 [00:05<01:26, 10.92it/s]Computing features:   6%|▋         | 65/1000 [00:05<01:25, 11.00it/s]Computing features:   7%|▋         | 71/1000 [00:06<01:25, 10.89it/s]Computing features:   8%|▊         | 77/1000 [00:07<01:25, 10.86it/s]Computing features:   8%|▊         | 83/1000 [00:07<01:24, 10.88it/s]Computing features:   9%|▉         | 89/1000 [00:08<01:23, 10.93it/s]Computing features:  10%|▉         | 95/1000 [00:08<01:23, 10.82it/s]Computing features:  10%|█         | 101/1000 [00:09<01:23, 10.83it/s]Computing features:  11%|█         | 107/1000 [00:10<01:26, 10.27it/s]Computing features:  11%|█▏        | 113/1000 [00:10<01:27, 10.11it/s]Computing features:  12%|█▏        | 119/1000 [00:11<01:27, 10.10it/s]Computing features:  12%|█▎        | 125/1000 [00:12<01:26, 10.17it/s]Computing features:  13%|█▎        | 132/1000 [00:12<01:23, 10.35it/s]Computing features:  14%|█▍        | 138/1000 [00:13<01:22, 10.43it/s]Computing features:  14%|█▍        | 144/1000 [00:13<01:23, 10.26it/s]Computing features:  15%|█▌        | 150/1000 [00:14<01:23, 10.22it/s]Computing features:  16%|█▌        | 156/1000 [00:15<01:24, 10.03it/s]Computing features:  16%|█▌        | 162/1000 [00:15<01:23, 10.04it/s]Computing features:  17%|█▋        | 168/1000 [00:16<01:23,  9.99it/s]Computing features:  17%|█▋        | 174/1000 [00:17<01:22,  9.98it/s]Computing features:  18%|█▊        | 180/1000 [00:17<01:22, 10.00it/s]Computing features:  19%|█▊        | 186/1000 [00:18<01:22,  9.91it/s]Computing features:  19%|█▉        | 192/1000 [00:18<01:21,  9.96it/s]Computing features:  20%|█▉        | 198/1000 [00:19<01:20,  9.93it/s]Computing features:  20%|██        | 204/1000 [00:20<01:19, 10.02it/s]Computing features:  21%|██        | 210/1000 [00:20<01:19,  9.89it/s]Computing features:  22%|██▏       | 216/1000 [00:21<01:18,  9.95it/s]Computing features:  22%|██▏       | 222/1000 [00:21<01:18,  9.97it/s]Computing features:  23%|██▎       | 229/1000 [00:22<01:16, 10.08it/s]Computing features:  24%|██▎       | 235/1000 [00:23<01:15, 10.08it/s]Computing features:  24%|██▍       | 241/1000 [00:23<01:14, 10.15it/s]Computing features:  25%|██▍       | 247/1000 [00:24<01:14, 10.15it/s]Computing features:  25%|██▌       | 253/1000 [00:24<01:14, 10.06it/s]Computing features:  26%|██▌       | 259/1000 [00:25<01:13, 10.08it/s]Computing features:  26%|██▋       | 265/1000 [00:26<01:13,  9.99it/s]Computing features:  27%|██▋       | 271/1000 [00:26<01:12, 10.02it/s]Computing features:  28%|██▊       | 277/1000 [00:27<01:12, 10.04it/s]Computing features:  28%|██▊       | 283/1000 [00:27<01:12,  9.93it/s]Computing features:  29%|██▉       | 289/1000 [00:28<01:11,  9.90it/s]Computing features:  30%|██▉       | 296/1000 [00:29<01:10, 10.03it/s]Computing features:  30%|███       | 302/1000 [00:29<01:09,  9.97it/s]Computing features:  31%|███       | 308/1000 [00:30<01:09,  9.96it/s]Computing features:  31%|███▏      | 314/1000 [00:31<01:08,  9.96it/s]Computing features:  32%|███▏      | 320/1000 [00:31<01:08, 10.00it/s]Computing features:  33%|███▎      | 326/1000 [00:32<01:07,  9.99it/s]Computing features:  33%|███▎      | 332/1000 [00:32<01:07,  9.92it/s]Computing features:  34%|███▍      | 338/1000 [00:33<01:07,  9.83it/s]Computing features:  34%|███▍      | 344/1000 [00:34<01:06,  9.91it/s]Computing features:  35%|███▌      | 350/1000 [00:34<01:05,  9.98it/s]Computing features:  36%|███▌      | 356/1000 [00:35<01:04, 10.02it/s]Computing features:  36%|███▌      | 362/1000 [00:35<01:03, 10.03it/s]Computing features:  37%|███▋      | 368/1000 [00:36<01:02, 10.08it/s]Computing features:  38%|███▊      | 375/1000 [00:36<01:01, 10.24it/s]Computing features:  38%|███▊      | 381/1000 [00:37<01:01, 10.14it/s]Computing features:  39%|███▊      | 387/1000 [00:38<01:00, 10.09it/s]Computing features:  39%|███▉      | 393/1000 [00:39<01:01,  9.93it/s]Computing features:  40%|███▉      | 399/1000 [00:39<01:00,  9.99it/s]Computing features:  40%|████      | 405/1000 [00:40<00:59,  9.95it/s]Computing features:  41%|████      | 411/1000 [00:40<00:58, 10.03it/s]Computing features:  42%|████▏     | 417/1000 [00:41<00:58,  9.99it/s]Computing features:  42%|████▏     | 424/1000 [00:41<00:56, 10.13it/s]Computing features:  43%|████▎     | 430/1000 [00:42<00:55, 10.20it/s]Computing features:  44%|████▎     | 436/1000 [00:42<00:55, 10.23it/s]Computing features:  44%|████▍     | 442/1000 [00:43<00:56,  9.88it/s]Computing features:  45%|████▍     | 448/1000 [00:44<00:57,  9.63it/s]Computing features:  45%|████▌     | 453/1000 [00:45<00:57,  9.52it/s]Computing features:  46%|████▌     | 461/1000 [00:46<00:55,  9.78it/s]Computing features:  47%|████▋     | 468/1000 [00:46<00:53,  9.94it/s]Computing features:  48%|████▊     | 476/1000 [00:47<00:51, 10.17it/s]Computing features:  48%|████▊     | 484/1000 [00:47<00:49, 10.38it/s]Computing features:  49%|████▉     | 492/1000 [00:48<00:47, 10.59it/s]Computing features:  50%|█████     | 502/1000 [00:48<00:45, 10.97it/s]Computing features:  51%|█████     | 512/1000 [00:49<00:43, 11.34it/s]Computing features:  52%|█████▏    | 522/1000 [00:49<00:40, 11.69it/s]Computing features:  53%|█████▎    | 533/1000 [00:50<00:38, 12.12it/s]Computing features:  54%|█████▍    | 543/1000 [00:50<00:36, 12.41it/s]Computing features:  55%|█████▌    | 552/1000 [00:51<00:35, 12.59it/s]Computing features:  56%|█████▌    | 560/1000 [00:51<00:34, 12.70it/s]Computing features:  57%|█████▋    | 567/1000 [00:52<00:33, 12.75it/s]Computing features:  57%|█████▊    | 575/1000 [00:52<00:33, 12.84it/s]Computing features:  58%|█████▊    | 582/1000 [00:53<00:32, 12.84it/s]Computing features:  59%|█████▉    | 590/1000 [00:53<00:31, 12.92it/s]Computing features:  60%|█████▉    | 597/1000 [00:54<00:31, 12.92it/s]Computing features:  60%|██████    | 604/1000 [00:55<00:30, 12.86it/s]Computing features:  61%|██████    | 611/1000 [00:55<00:30, 12.68it/s]Computing features:  62%|██████▏   | 618/1000 [00:56<00:30, 12.72it/s]Computing features:  62%|██████▎   | 625/1000 [00:56<00:29, 12.72it/s]Computing features:  63%|██████▎   | 632/1000 [00:57<00:29, 12.66it/s]Computing features:  64%|██████▍   | 639/1000 [00:58<00:28, 12.60it/s]Computing features:  65%|██████▍   | 646/1000 [00:58<00:28, 12.39it/s]Computing features:  65%|██████▌   | 653/1000 [00:59<00:28, 12.36it/s]Computing features:  66%|██████▌   | 660/1000 [01:00<00:27, 12.36it/s]Computing features:  67%|██████▋   | 668/1000 [01:00<00:26, 12.48it/s]Computing features:  68%|██████▊   | 675/1000 [01:01<00:25, 12.54it/s]Computing features:  68%|██████▊   | 684/1000 [01:01<00:24, 12.74it/s]Computing features:  69%|██████▉   | 693/1000 [01:02<00:23, 12.87it/s]Computing features:  70%|███████   | 702/1000 [01:02<00:22, 13.01it/s]Computing features:  71%|███████   | 709/1000 [01:03<00:22, 12.76it/s]Computing features:  72%|███████▏  | 716/1000 [01:04<00:23, 12.25it/s]Computing features:  72%|███████▏  | 723/1000 [01:05<00:23, 11.76it/s]Computing features:  73%|███████▎  | 730/1000 [01:06<00:23, 11.36it/s]Computing features:  74%|███████▎  | 737/1000 [01:07<00:23, 11.04it/s]Computing features:  74%|███████▍  | 743/1000 [01:08<00:23, 10.87it/s]Computing features:  75%|███████▍  | 749/1000 [01:09<00:23, 10.66it/s]Computing features:  76%|███████▌  | 755/1000 [01:10<00:23, 10.45it/s]Computing features:  76%|███████▌  | 761/1000 [01:10<00:23, 10.34it/s]Computing features:  77%|███████▋  | 767/1000 [01:11<00:22, 10.19it/s]Computing features:  77%|███████▋  | 773/1000 [01:12<00:22, 10.09it/s]Computing features:  78%|███████▊  | 779/1000 [01:13<00:22,  9.96it/s]Computing features:  78%|███████▊  | 785/1000 [01:14<00:22,  9.69it/s]Computing features:  79%|███████▉  | 791/1000 [01:15<00:22,  9.44it/s]Computing features:  80%|███████▉  | 797/1000 [01:15<00:21,  9.44it/s]Computing features:  80%|████████  | 803/1000 [01:16<00:20,  9.43it/s]Computing features:  81%|████████  | 809/1000 [01:16<00:20,  9.45it/s]Computing features:  82%|████████▏ | 815/1000 [01:17<00:19,  9.53it/s]Computing features:  82%|████████▏ | 821/1000 [01:18<00:18,  9.52it/s]Computing features:  83%|████████▎ | 827/1000 [01:18<00:18,  9.54it/s]Computing features:  83%|████████▎ | 833/1000 [01:19<00:17,  9.56it/s]Computing features:  84%|████████▍ | 839/1000 [01:19<00:16,  9.60it/s]Computing features:  84%|████████▍ | 845/1000 [01:20<00:16,  9.48it/s]Computing features:  85%|████████▌ | 851/1000 [01:21<00:15,  9.51it/s]Computing features:  86%|████████▌ | 857/1000 [01:21<00:15,  9.53it/s]Computing features:  86%|████████▋ | 863/1000 [01:22<00:14,  9.47it/s]Computing features:  87%|████████▋ | 869/1000 [01:23<00:13,  9.53it/s]Computing features:  87%|████████▋ | 874/1000 [01:23<00:13,  9.53it/s]Computing features:  88%|████████▊ | 881/1000 [01:24<00:12,  9.69it/s]Computing features:  89%|████████▊ | 887/1000 [01:24<00:11,  9.72it/s]Computing features:  90%|████████▉ | 895/1000 [01:25<00:10,  9.89it/s]Computing features:  90%|█████████ | 901/1000 [01:25<00:10,  9.86it/s]Computing features:  91%|█████████ | 907/1000 [01:26<00:09,  9.92it/s]Computing features:  91%|█████████▏| 913/1000 [01:27<00:08,  9.89it/s]Computing features:  92%|█████████▏| 919/1000 [01:27<00:08,  9.96it/s]Computing features:  92%|█████████▎| 925/1000 [01:28<00:07,  9.95it/s]Computing features:  93%|█████████▎| 931/1000 [01:28<00:06,  9.96it/s]Computing features:  94%|█████████▎| 937/1000 [01:29<00:06,  9.93it/s]Computing features:  94%|█████████▍| 943/1000 [01:30<00:05,  9.98it/s]Computing features:  95%|█████████▌| 950/1000 [01:30<00:04, 10.11it/s]Computing features:  96%|█████████▌| 956/1000 [01:31<00:04, 10.16it/s]Computing features:  96%|█████████▌| 962/1000 [01:31<00:03, 10.21it/s]Computing features:  97%|█████████▋| 968/1000 [01:32<00:03, 10.20it/s]Computing features:  97%|█████████▋| 974/1000 [01:32<00:02, 10.25it/s]Computing features:  98%|█████████▊| 980/1000 [01:33<00:01, 10.16it/s]Computing features:  99%|█████████▊| 986/1000 [01:33<00:01, 10.21it/s]Computing features:  99%|█████████▉| 992/1000 [01:34<00:00, 10.16it/s]Computing features: 100%|█████████▉| 998/1000 [01:35<00:00, 10.19it/s]Computing features: 100%|██████████| 1000/1000 [01:35<00:00, 10.48it/s]
19:11:25 - INFO - Built flat FAISS index: 1000 images, dimension 96
19:11:25 - INFO - Saving FAISS cache...
19:11:25 - INFO - FAISS cache saved successfully
19:11:25 - INFO - Video aspect ratio: 1.778
19:11:25 - INFO - Processing 599 frames...
Matching frames:   0%|          | 0/599 [00:00<?, ?it/s]Matching frames:   3%|▎         | 15/599 [00:00<00:21, 27.55it/s]Matching frames:   5%|▍         | 29/599 [00:01<00:20, 27.19it/s]Matching frames:   7%|▋         | 44/599 [00:01<00:19, 27.99it/s]Matching frames:  10%|▉         | 59/599 [00:02<00:19, 27.82it/s]Matching frames:  14%|█▍        | 83/599 [00:02<00:16, 31.50it/s]Matching frames:  17%|█▋        | 101/599 [00:03<00:15, 32.24it/s]Matching frames:  20%|█▉        | 118/599 [00:03<00:15, 32.05it/s]Matching frames:  23%|██▎       | 135/599 [00:04<00:14, 31.18it/s]Matching frames:  25%|██▌       | 151/599 [00:05<00:15, 28.02it/s]Matching frames:  28%|██▊       | 166/599 [00:05<00:15, 27.27it/s]Matching frames:  30%|███       | 181/599 [00:06<00:15, 26.90it/s]Matching frames:  33%|███▎      | 195/599 [00:07<00:15, 26.86it/s]Matching frames:  35%|███▍      | 209/599 [00:08<00:15, 24.96it/s]Matching frames:  37%|███▋      | 223/599 [00:08<00:15, 24.99it/s]Matching frames:  40%|████      | 240/599 [00:09<00:14, 25.63it/s]Matching frames:  43%|████▎     | 259/599 [00:09<00:12, 26.41it/s]Matching frames:  48%|████▊     | 285/599 [00:10<00:11, 28.10it/s]Matching frames:  50%|█████     | 301/599 [00:10<00:10, 27.96it/s]Matching frames:  53%|█████▎    | 319/599 [00:11<00:09, 28.27it/s]Matching frames:  56%|█████▌    | 335/599 [00:11<00:09, 28.47it/s]Matching frames:  58%|█████▊    | 350/599 [00:12<00:08, 27.83it/s]Matching frames:  61%|██████    | 365/599 [00:13<00:08, 26.26it/s]Matching frames:  64%|██████▍   | 382/599 [00:14<00:08, 26.68it/s]Matching frames:  66%|██████▋   | 397/599 [00:14<00:07, 26.58it/s]Matching frames:  69%|██████▉   | 412/599 [00:15<00:07, 26.10it/s]Matching frames:  71%|███████   | 426/599 [00:16<00:06, 24.93it/s]Matching frames:  73%|███████▎  | 440/599 [00:17<00:06, 24.55it/s]Matching frames:  76%|███████▌  | 454/599 [00:17<00:05, 24.47it/s]Matching frames:  78%|███████▊  | 468/599 [00:18<00:05, 24.49it/s]Matching frames:  80%|████████  | 481/599 [00:18<00:04, 24.43it/s]Matching frames:  82%|████████▏ | 494/599 [00:19<00:04, 24.35it/s]Matching frames:  85%|████████▍ | 507/599 [00:20<00:03, 23.78it/s]Matching frames:  87%|████████▋ | 520/599 [00:20<00:03, 23.56it/s]Matching frames:  89%|████████▉ | 535/599 [00:21<00:02, 23.76it/s]Matching frames:  91%|█████████▏| 548/599 [00:21<00:02, 23.74it/s]Matching frames:  94%|█████████▎| 561/599 [00:22<00:01, 23.45it/s]Matching frames:  96%|█████████▌| 575/599 [00:23<00:01, 23.56it/s]Matching frames:  98%|█████████▊| 588/599 [00:23<00:00, 23.53it/s]Matching frames: 100%|██████████| 599/599 [00:24<00:00, 24.17it/s]
19:11:50 - INFO - Results saved to output_gem_2x2/results.json
19:11:50 - INFO - Verification: All frames have valid selections
19:11:50 - INFO - Generating output...
19:11:51 - INFO - Output FPS: 25.0 (input: 59.94)
Generating output:   0%|          | 0/300 [00:00<?, ?it/s]Generating output:   2%|▏         | 5/300 [00:00<00:30,  9.56it/s]Generating output:   4%|▎         | 11/300 [00:01<00:28, 10.07it/s]Generating output:   6%|▌         | 17/300 [00:01<00:26, 10.63it/s]Generating output:   8%|▊         | 23/300 [00:02<00:26, 10.64it/s]Generating output:  10%|▉         | 29/300 [00:02<00:24, 10.92it/s]Generating output:  12%|█▏        | 36/300 [00:03<00:23, 11.13it/s]Generating output:  15%|█▍        | 44/300 [00:03<00:21, 11.64it/s]Generating output:  17%|█▋        | 51/300 [00:04<00:20, 11.88it/s]Generating output:  19%|█▉        | 58/300 [00:04<00:19, 12.11it/s]Generating output:  22%|██▏       | 66/300 [00:05<00:18, 12.46it/s]Generating output:  24%|██▍       | 73/300 [00:05<00:18, 12.52it/s]Generating output:  27%|██▋       | 80/300 [00:06<00:17, 12.34it/s]Generating output:  29%|██▉       | 87/300 [00:07<00:17, 12.16it/s]Generating output:  31%|███▏      | 94/300 [00:07<00:17, 11.96it/s]Generating output:  34%|███▎      | 101/300 [00:08<00:16, 11.87it/s]Generating output:  36%|███▌      | 107/300 [00:09<00:16, 11.78it/s]Generating output:  38%|███▊      | 113/300 [00:09<00:15, 11.70it/s]Generating output:  40%|████      | 120/300 [00:10<00:15, 11.73it/s]Generating output:  42%|████▏     | 126/300 [00:10<00:14, 11.72it/s]Generating output:  44%|████▍     | 133/300 [00:11<00:14, 11.79it/s]Generating output:  46%|████▋     | 139/300 [00:11<00:13, 11.79it/s]Generating output:  49%|████▊     | 146/300 [00:12<00:12, 11.90it/s]Generating output:  51%|█████     | 152/300 [00:12<00:12, 11.80it/s]Generating output:  53%|█████▎    | 159/300 [00:13<00:11, 11.81it/s]Generating output:  55%|█████▌    | 165/300 [00:14<00:11, 11.69it/s]Generating output:  57%|█████▋    | 171/300 [00:14<00:11, 11.57it/s]Generating output:  59%|█████▉    | 177/300 [00:15<00:10, 11.45it/s]Generating output:  61%|██████    | 183/300 [00:15<00:10, 11.35it/s]Generating output:  63%|██████▎   | 190/300 [00:16<00:09, 11.39it/s]Generating output:  65%|██████▌   | 196/300 [00:17<00:09, 11.31it/s]Generating output:  67%|██████▋   | 202/300 [00:17<00:08, 11.34it/s]Generating output:  69%|██████▉   | 208/300 [00:18<00:08, 11.33it/s]Generating output:  71%|███████▏  | 214/300 [00:18<00:07, 11.30it/s]Generating output:  73%|███████▎  | 220/300 [00:19<00:07, 11.33it/s]Generating output:  75%|███████▌  | 226/300 [00:19<00:06, 11.36it/s]Generating output:  78%|███████▊  | 233/300 [00:20<00:05, 11.43it/s]Generating output:  80%|███████▉  | 239/300 [00:20<00:05, 11.36it/s]Generating output:  82%|████████▏ | 245/300 [00:21<00:04, 11.32it/s]Generating output:  84%|████████▎ | 251/300 [00:21<00:04, 11.23it/s]Generating output:  86%|████████▌ | 257/300 [00:22<00:03, 11.17it/s]Generating output:  88%|████████▊ | 263/300 [00:23<00:03, 11.09it/s]Generating output:  90%|████████▉ | 269/300 [00:23<00:02, 11.09it/s]Generating output:  92%|█████████▏| 276/300 [00:24<00:02, 11.19it/s]Generating output:  95%|█████████▌| 285/300 [00:24<00:01, 11.47it/s]Generating output:  98%|█████████▊| 293/300 [00:25<00:00, 11.68it/s]Generating output: 100%|██████████| 300/300 [00:25<00:00, 11.68it/s]
19:12:16 - INFO - Output video saved to: output_gem_2x2/Winter Cycling： Vantaa, Finland - 4K 60fps_matched.mp4
19:12:16 - INFO - Output images saved to: output_gem_2x2/matched_frames

Done!

real	3m5,689s
user	10m17,157s
sys	0m20,191s

5/5: GeM + global (1x1)
19:12:17 - INFO - Video: /home/birgit/Downloads/Winter Cycling： Vantaa, Finland - 4K 60fps.mp4
19:12:17 - INFO - Image folder: /home/birgit/fiftyone/open-images-v7/train/data
19:12:17 - INFO - Output directory: output_gem_global
19:12:17 - INFO - Search depth: 10
19:12:17 - INFO - Similarity threshold: 0.0
19:12:17 - INFO - No repeat: True
19:12:17 - INFO - Checkpoint batch size: 10
19:12:17 - INFO - Feature method: mobilenet
19:12:17 - INFO - Demo mode: ON (max 10s video, 1000 images)
19:12:17 - INFO - Weights - Edge: 0.60, Texture: 0.20, Color: 0.20
19:12:18 - INFO - FPS override: 25.0 (input: 59.94, skip interval: 2)
19:12:18 - INFO - Demo mode: Processing first 10 seconds (599 frames) out of 123084
19:12:18 - INFO - Scanning image folder...
19:12:34 - INFO - Sorting 467000 image paths...
19:12:54 - INFO - Demo mode: Using first 1000 images out of 467000
19:12:57 - INFO - Found 1000 images in folder
19:12:57 - INFO - Preparing FAISS index...
19:12:57 - INFO - Cache files not found, will rebuild
19:12:57 - INFO - Building FAISS index for 1000 images...
19:12:57 - INFO -   Comparison size: 256px
19:12:57 - INFO -   Using single-process mode (ONNX Runtime handles threading)
Computing features:   0%|          | 0/1000 [00:00<?, ?it/s]Computing features:   1%|          | 7/1000 [00:00<01:17, 12.78it/s]Computing features:   1%|▏         | 14/1000 [00:01<01:35, 10.30it/s]Computing features:   2%|▏         | 20/1000 [00:02<01:42,  9.57it/s]Computing features:   3%|▎         | 26/1000 [00:02<01:38,  9.88it/s]Computing features:   3%|▎         | 33/1000 [00:03<01:34, 10.27it/s]Computing features:   4%|▍         | 39/1000 [00:03<01:33, 10.27it/s]Computing features:   4%|▍         | 45/1000 [00:04<01:32, 10.30it/s]Computing features:   5%|▌         | 51/1000 [00:04<01:32, 10.30it/s]Computing features:   6%|▌         | 57/1000 [00:05<01:31, 10.36it/s]Computing features:   6%|▋         | 63/1000 [00:06<01:31, 10.21it/s]Computing features:   7%|▋         | 69/1000 [00:06<01:31, 10.16it/s]Computing features:   8%|▊         | 75/1000 [00:07<01:31, 10.15it/s]Computing features:   8%|▊         | 81/1000 [00:07<01:30, 10.16it/s]Computing features:   9%|▊         | 87/1000 [00:08<01:29, 10.16it/s]Computing features:   9%|▉         | 93/1000 [00:09<01:30,  9.97it/s]Computing features:  10%|▉         | 99/1000 [00:09<01:29, 10.04it/s]Computing features:  10%|█         | 105/1000 [00:10<01:28, 10.12it/s]Computing features:  11%|█         | 111/1000 [00:10<01:27, 10.18it/s]Computing features:  12%|█▏        | 117/1000 [00:11<01:26, 10.16it/s]Computing features:  12%|█▎        | 125/1000 [00:12<01:23, 10.44it/s]Computing features:  13%|█▎        | 131/1000 [00:12<01:22, 10.48it/s]Computing features:  14%|█▎        | 137/1000 [00:13<01:22, 10.47it/s]Computing features:  14%|█▍        | 143/1000 [00:13<01:22, 10.41it/s]Computing features:  15%|█▍        | 149/1000 [00:14<01:23, 10.18it/s]Computing features:  16%|█▌        | 155/1000 [00:15<01:23, 10.15it/s]Computing features:  16%|█▌        | 161/1000 [00:15<01:22, 10.20it/s]Computing features:  17%|█▋        | 167/1000 [00:16<01:21, 10.24it/s]Computing features:  17%|█▋        | 173/1000 [00:16<01:20, 10.21it/s]Computing features:  18%|█▊        | 179/1000 [00:17<01:20, 10.23it/s]Computing features:  19%|█▊        | 186/1000 [00:18<01:18, 10.42it/s]Computing features:  19%|█▉        | 193/1000 [00:18<01:16, 10.58it/s]Computing features:  20%|█▉        | 199/1000 [00:19<01:15, 10.59it/s]Computing features:  20%|██        | 205/1000 [00:19<01:15, 10.56it/s]Computing features:  21%|██        | 211/1000 [00:20<01:14, 10.56it/s]Computing features:  22%|██▏       | 217/1000 [00:20<01:14, 10.52it/s]Computing features:  22%|██▏       | 223/1000 [00:21<01:13, 10.51it/s]Computing features:  23%|██▎       | 229/1000 [00:22<01:14, 10.39it/s]Computing features:  24%|██▎       | 235/1000 [00:22<01:14, 10.27it/s]Computing features:  24%|██▍       | 241/1000 [00:23<01:14, 10.24it/s]Computing features:  25%|██▍       | 247/1000 [00:23<01:13, 10.31it/s]Computing features:  25%|██▌       | 253/1000 [00:24<01:13, 10.21it/s]Computing features:  26%|██▌       | 259/1000 [00:25<01:13, 10.06it/s]Computing features:  26%|██▋       | 265/1000 [00:26<01:15,  9.78it/s]Computing features:  27%|██▋       | 271/1000 [00:26<01:14,  9.82it/s]Computing features:  28%|██▊       | 277/1000 [00:27<01:12,  9.91it/s]Computing features:  28%|██▊       | 284/1000 [00:27<01:11, 10.05it/s]Computing features:  29%|██▉       | 290/1000 [00:28<01:10, 10.13it/s]Computing features:  30%|██▉       | 296/1000 [00:28<01:09, 10.16it/s]Computing features:  30%|███       | 302/1000 [00:29<01:09, 10.10it/s]Computing features:  31%|███       | 308/1000 [00:30<01:08, 10.14it/s]Computing features:  31%|███▏      | 314/1000 [00:30<01:07, 10.16it/s]Computing features:  32%|███▏      | 321/1000 [00:31<01:06, 10.25it/s]Computing features:  33%|███▎      | 327/1000 [00:31<01:05, 10.29it/s]Computing features:  33%|███▎      | 334/1000 [00:32<01:04, 10.38it/s]Computing features:  34%|███▍      | 340/1000 [00:33<01:04, 10.28it/s]Computing features:  35%|███▍      | 346/1000 [00:33<01:03, 10.22it/s]Computing features:  35%|███▌      | 352/1000 [00:34<01:03, 10.19it/s]Computing features:  36%|███▌      | 358/1000 [00:35<01:03, 10.18it/s]Computing features:  36%|███▋      | 364/1000 [00:35<01:02, 10.17it/s]Computing features:  37%|███▋      | 370/1000 [00:36<01:02, 10.14it/s]Computing features:  38%|███▊      | 376/1000 [00:36<01:02, 10.06it/s]Computing features:  38%|███▊      | 382/1000 [00:37<01:01, 10.05it/s]Computing features:  39%|███▉      | 388/1000 [00:38<01:01, 10.02it/s]Computing features:  39%|███▉      | 394/1000 [00:38<01:00, 10.01it/s]Computing features:  40%|████      | 400/1000 [00:39<00:59, 10.01it/s]Computing features:  41%|████      | 406/1000 [00:39<00:59, 10.02it/s]Computing features:  41%|████      | 412/1000 [00:40<00:58, 10.08it/s]Computing features:  42%|████▏     | 418/1000 [00:41<00:57, 10.11it/s]Computing features:  42%|████▎     | 425/1000 [00:41<00:56, 10.24it/s]Computing features:  43%|████▎     | 431/1000 [00:42<00:55, 10.31it/s]Computing features:  44%|████▎     | 437/1000 [00:42<00:54, 10.38it/s]Computing features:  44%|████▍     | 443/1000 [00:43<00:53, 10.33it/s]Computing features:  45%|████▍     | 449/1000 [00:43<00:53, 10.37it/s]Computing features:  46%|████▌     | 455/1000 [00:44<00:53, 10.22it/s]Computing features:  46%|████▌     | 461/1000 [00:45<00:54,  9.92it/s]Computing features:  47%|████▋     | 467/1000 [00:46<00:54,  9.78it/s]Computing features:  47%|████▋     | 474/1000 [00:46<00:52,  9.94it/s]Computing features:  48%|████▊     | 483/1000 [00:47<00:50, 10.25it/s]Computing features:  49%|████▉     | 493/1000 [00:47<00:47, 10.64it/s]Computing features:  50%|█████     | 503/1000 [00:48<00:45, 11.03it/s]Computing features:  51%|█████▏    | 514/1000 [00:48<00:42, 11.49it/s]Computing features:  52%|█████▏    | 523/1000 [00:49<00:40, 11.76it/s]Computing features:  53%|█████▎    | 534/1000 [00:49<00:38, 12.14it/s]Computing features:  54%|█████▍    | 542/1000 [00:50<00:37, 12.29it/s]Computing features:  55%|█████▌    | 550/1000 [00:50<00:36, 12.40it/s]Computing features:  56%|█████▌    | 557/1000 [00:51<00:35, 12.42it/s]Computing features:  56%|█████▋    | 564/1000 [00:52<00:34, 12.46it/s]Computing features:  57%|█████▋    | 571/1000 [00:52<00:34, 12.39it/s]Computing features:  58%|█████▊    | 578/1000 [00:53<00:34, 12.30it/s]Computing features:  58%|█████▊    | 585/1000 [00:53<00:33, 12.33it/s]Computing features:  59%|█████▉    | 592/1000 [00:54<00:33, 12.21it/s]Computing features:  60%|█████▉    | 599/1000 [00:55<00:32, 12.18it/s]Computing features:  61%|██████    | 606/1000 [00:55<00:32, 12.15it/s]Computing features:  61%|██████▏   | 613/1000 [00:56<00:31, 12.15it/s]Computing features:  62%|██████▏   | 620/1000 [00:56<00:31, 12.16it/s]Computing features:  63%|██████▎   | 627/1000 [00:57<00:30, 12.13it/s]Computing features:  63%|██████▎   | 634/1000 [00:58<00:30, 12.16it/s]Computing features:  64%|██████▍   | 641/1000 [00:58<00:29, 12.03it/s]Computing features:  65%|██████▍   | 648/1000 [00:59<00:29, 11.88it/s]Computing features:  66%|██████▌   | 655/1000 [01:00<00:29, 11.75it/s]Computing features:  66%|██████▌   | 662/1000 [01:00<00:29, 11.60it/s]Computing features:  67%|██████▋   | 668/1000 [01:01<00:28, 11.59it/s]Computing features:  68%|██████▊   | 675/1000 [01:02<00:27, 11.61it/s]Computing features:  68%|██████▊   | 681/1000 [01:02<00:27, 11.60it/s]Computing features:  69%|██████▉   | 690/1000 [01:03<00:26, 11.83it/s]Computing features:  70%|██████▉   | 698/1000 [01:03<00:25, 11.97it/s]Computing features:  70%|███████   | 705/1000 [01:04<00:24, 11.88it/s]Computing features:  71%|███████   | 712/1000 [01:05<00:24, 11.69it/s]Computing features:  72%|███████▏  | 719/1000 [01:05<00:24, 11.44it/s]Computing features:  72%|███████▎  | 725/1000 [01:06<00:24, 11.08it/s]Computing features:  73%|███████▎  | 731/1000 [01:07<00:24, 10.81it/s]Computing features:  74%|███████▎  | 737/1000 [01:08<00:24, 10.66it/s]Computing features:  74%|███████▍  | 743/1000 [01:09<00:24, 10.30it/s]Computing features:  75%|███████▍  | 749/1000 [01:10<00:25,  9.89it/s]Computing features:  76%|███████▌  | 755/1000 [01:11<00:25,  9.67it/s]Computing features:  76%|███████▌  | 761/1000 [01:12<00:25,  9.35it/s]Computing features:  77%|███████▋  | 767/1000 [01:13<00:25,  9.18it/s]Computing features:  77%|███████▋  | 772/1000 [01:14<00:24,  9.17it/s]Computing features:  78%|███████▊  | 777/1000 [01:14<00:24,  9.13it/s]Computing features:  78%|███████▊  | 782/1000 [01:15<00:24,  9.04it/s]Computing features:  79%|███████▊  | 787/1000 [01:16<00:23,  8.99it/s]Computing features:  79%|███████▉  | 792/1000 [01:16<00:23,  8.94it/s]Computing features:  80%|███████▉  | 797/1000 [01:17<00:22,  8.92it/s]Computing features:  80%|████████  | 802/1000 [01:17<00:22,  8.89it/s]Computing features:  81%|████████  | 807/1000 [01:18<00:21,  8.88it/s]Computing features:  81%|████████  | 812/1000 [01:18<00:21,  8.90it/s]Computing features:  82%|████████▏ | 817/1000 [01:19<00:20,  8.86it/s]Computing features:  82%|████████▏ | 823/1000 [01:20<00:19,  8.97it/s]Computing features:  83%|████████▎ | 828/1000 [01:20<00:19,  8.97it/s]Computing features:  83%|████████▎ | 833/1000 [01:21<00:18,  8.90it/s]Computing features:  84%|████████▍ | 838/1000 [01:21<00:18,  8.88it/s]Computing features:  84%|████████▍ | 844/1000 [01:22<00:17,  9.00it/s]Computing features:  85%|████████▍ | 849/1000 [01:22<00:16,  9.01it/s]Computing features:  86%|████████▌ | 855/1000 [01:23<00:15,  9.07it/s]Computing features:  86%|████████▌ | 860/1000 [01:24<00:15,  9.10it/s]Computing features:  86%|████████▋ | 865/1000 [01:24<00:14,  9.12it/s]Computing features:  87%|████████▋ | 871/1000 [01:25<00:14,  9.17it/s]Computing features:  88%|████████▊ | 876/1000 [01:25<00:13,  9.14it/s]Computing features:  88%|████████▊ | 881/1000 [01:26<00:13,  9.15it/s]Computing features:  89%|████████▊ | 886/1000 [01:26<00:12,  9.09it/s]Computing features:  89%|████████▉ | 891/1000 [01:27<00:12,  9.07it/s]Computing features:  90%|████████▉ | 896/1000 [01:28<00:11,  9.09it/s]Computing features:  90%|█████████ | 901/1000 [01:28<00:10,  9.06it/s]Computing features:  91%|█████████ | 906/1000 [01:29<00:10,  9.06it/s]Computing features:  91%|█████████ | 912/1000 [01:29<00:09,  9.10it/s]Computing features:  92%|█████████▏| 918/1000 [01:30<00:08,  9.16it/s]Computing features:  92%|█████████▏| 923/1000 [01:30<00:08,  9.18it/s]Computing features:  93%|█████████▎| 928/1000 [01:31<00:07,  9.19it/s]Computing features:  93%|█████████▎| 934/1000 [01:31<00:07,  9.25it/s]Computing features:  94%|█████████▍| 939/1000 [01:32<00:06,  9.28it/s]Computing features:  94%|█████████▍| 944/1000 [01:33<00:06,  9.22it/s]Computing features:  95%|█████████▌| 950/1000 [01:33<00:05,  9.29it/s]Computing features:  96%|█████████▌| 955/1000 [01:34<00:04,  9.31it/s]Computing features:  96%|█████████▌| 960/1000 [01:34<00:04,  9.27it/s]Computing features:  96%|█████████▋| 965/1000 [01:35<00:03,  9.25it/s]Computing features:  97%|█████████▋| 970/1000 [01:35<00:03,  9.17it/s]Computing features:  98%|█████████▊| 975/1000 [01:36<00:02,  9.19it/s]Computing features:  98%|█████████▊| 981/1000 [01:37<00:02,  9.21it/s]Computing features:  99%|█████████▊| 987/1000 [01:37<00:01,  9.22it/s]Computing features:  99%|█████████▉| 992/1000 [01:38<00:00,  9.10it/s]Computing features: 100%|█████████▉| 998/1000 [01:39<00:00,  9.16it/s]Computing features: 100%|██████████| 1000/1000 [01:39<00:00, 10.08it/s]
19:14:36 - INFO - Built flat FAISS index: 1000 images, dimension 24
19:14:36 - INFO - Saving FAISS cache...
19:14:36 - INFO - FAISS cache saved successfully
19:14:36 - INFO - Video aspect ratio: 1.778
19:14:36 - INFO - Processing 599 frames...
Matching frames:   0%|          | 0/599 [00:00<?, ?it/s]Matching frames:   1%|▏         | 8/599 [00:00<00:37, 15.70it/s]Matching frames:   4%|▍         | 23/599 [00:01<00:25, 22.69it/s]Matching frames:   7%|▋         | 41/599 [00:01<00:20, 27.09it/s]Matching frames:   9%|▉         | 55/599 [00:02<00:23, 23.08it/s]Matching frames:  11%|█▏        | 68/599 [00:02<00:23, 22.95it/s]Matching frames:  14%|█▎        | 81/599 [00:03<00:22, 23.39it/s]Matching frames:  16%|█▌        | 95/599 [00:04<00:21, 23.56it/s]Matching frames:  18%|█▊        | 108/599 [00:04<00:21, 22.96it/s]Matching frames:  20%|██        | 121/599 [00:05<00:20, 23.17it/s]Matching frames:  22%|██▏       | 133/599 [00:05<00:20, 23.06it/s]Matching frames:  24%|██▍       | 145/599 [00:06<00:19, 22.93it/s]Matching frames:  26%|██▌       | 157/599 [00:06<00:19, 22.22it/s]Matching frames:  29%|██▉       | 176/599 [00:07<00:17, 23.62it/s]Matching frames:  33%|███▎      | 197/599 [00:08<00:16, 25.07it/s]Matching frames:  36%|███▌      | 213/599 [00:08<00:15, 25.57it/s]Matching frames:  38%|███▊      | 227/599 [00:09<00:14, 25.33it/s]Matching frames:  40%|████      | 240/599 [00:09<00:14, 25.13it/s]Matching frames:  42%|████▏     | 253/599 [00:10<00:14, 24.47it/s]Matching frames:  45%|████▍     | 267/599 [00:10<00:13, 24.68it/s]Matching frames:  47%|████▋     | 282/599 [00:11<00:12, 24.97it/s]Matching frames:  49%|████▉     | 295/599 [00:12<00:12, 24.53it/s]Matching frames:  52%|█████▏    | 310/599 [00:12<00:11, 24.87it/s]Matching frames:  54%|█████▍    | 326/599 [00:13<00:10, 25.30it/s]Matching frames:  57%|█████▋    | 341/599 [00:13<00:10, 25.58it/s]Matching frames:  59%|█████▉    | 355/599 [00:14<00:09, 25.30it/s]Matching frames:  61%|██████▏   | 368/599 [00:14<00:09, 25.01it/s]Matching frames:  64%|██████▎   | 381/599 [00:15<00:08, 24.82it/s]Matching frames:  66%|██████▋   | 398/599 [00:15<00:07, 25.34it/s]Matching frames:  69%|██████▉   | 413/599 [00:16<00:07, 25.40it/s]Matching frames:  71%|███████   | 426/599 [00:17<00:06, 25.05it/s]Matching frames:  74%|███████▍  | 444/599 [00:17<00:06, 25.65it/s]Matching frames:  77%|███████▋  | 459/599 [00:18<00:05, 25.61it/s]Matching frames:  80%|███████▉  | 477/599 [00:18<00:04, 26.10it/s]Matching frames:  82%|████████▏ | 493/599 [00:19<00:04, 26.32it/s]Matching frames:  85%|████████▍ | 507/599 [00:20<00:03, 25.52it/s]Matching frames:  87%|████████▋ | 521/599 [00:20<00:03, 25.24it/s]Matching frames:  89%|████████▉ | 534/599 [00:21<00:02, 25.24it/s]Matching frames:  91%|█████████▏| 547/599 [00:21<00:02, 24.95it/s]Matching frames:  93%|█████████▎| 560/599 [00:22<00:01, 24.57it/s]Matching frames:  96%|█████████▌| 575/599 [00:23<00:00, 24.74it/s]Matching frames:  98%|█████████▊| 588/599 [00:23<00:00, 24.50it/s]Matching frames: 100%|██████████| 599/599 [00:24<00:00, 24.37it/s]
19:15:01 - INFO - Results saved to output_gem_global/results.json
19:15:01 - INFO - Verification: All frames have valid selections
19:15:01 - INFO - Generating output...
19:15:02 - INFO - Output FPS: 25.0 (input: 59.94)
Generating output:   0%|          | 0/300 [00:00<?, ?it/s]Generating output:   2%|▏         | 6/300 [00:00<00:27, 10.65it/s]Generating output:   4%|▍         | 12/300 [00:01<00:25, 11.16it/s]Generating output:   6%|▌         | 18/300 [00:01<00:25, 11.12it/s]Generating output:   8%|▊         | 24/300 [00:02<00:24, 11.07it/s]Generating output:  10%|█         | 30/300 [00:02<00:24, 11.24it/s]Generating output:  12%|█▏        | 36/300 [00:03<00:23, 11.34it/s]Generating output:  14%|█▍        | 42/300 [00:03<00:22, 11.24it/s]Generating output:  16%|█▌        | 48/300 [00:04<00:22, 11.14it/s]Generating output:  18%|█▊        | 54/300 [00:04<00:22, 11.08it/s]Generating output:  20%|██        | 60/300 [00:05<00:21, 11.02it/s]Generating output:  22%|██▏       | 67/300 [00:06<00:20, 11.16it/s]Generating output:  24%|██▍       | 73/300 [00:06<00:20, 11.17it/s]Generating output:  26%|██▋       | 79/300 [00:07<00:19, 11.14it/s]Generating output:  28%|██▊       | 85/300 [00:07<00:19, 11.10it/s]Generating output:  30%|███       | 91/300 [00:08<00:18, 11.07it/s]Generating output:  32%|███▏      | 97/300 [00:08<00:18, 11.04it/s]Generating output:  34%|███▍      | 103/300 [00:09<00:17, 11.07it/s]Generating output:  36%|███▋      | 109/300 [00:09<00:17, 11.07it/s]Generating output:  39%|███▊      | 116/300 [00:10<00:16, 11.19it/s]Generating output:  41%|████      | 122/300 [00:10<00:15, 11.20it/s]Generating output:  43%|████▎     | 128/300 [00:11<00:15, 11.22it/s]Generating output:  45%|████▌     | 135/300 [00:12<00:14, 11.30it/s]Generating output:  47%|████▋     | 142/300 [00:12<00:13, 11.39it/s]Generating output:  50%|████▉     | 149/300 [00:13<00:13, 11.49it/s]Generating output:  52%|█████▏    | 155/300 [00:13<00:12, 11.43it/s]Generating output:  54%|█████▎    | 161/300 [00:14<00:12, 11.38it/s]Generating output:  56%|█████▌    | 167/300 [00:14<00:11, 11.30it/s]Generating output:  58%|█████▊    | 173/300 [00:15<00:11, 11.19it/s]Generating output:  60%|█████▉    | 179/300 [00:15<00:10, 11.18it/s]Generating output:  62%|██████▏   | 185/300 [00:16<00:10, 11.16it/s]Generating output:  64%|██████▎   | 191/300 [00:17<00:09, 11.13it/s]Generating output:  66%|██████▌   | 197/300 [00:17<00:09, 11.03it/s]Generating output:  68%|██████▊   | 203/300 [00:18<00:08, 11.04it/s]Generating output:  70%|██████▉   | 209/300 [00:18<00:08, 11.03it/s]Generating output:  72%|███████▏  | 215/300 [00:19<00:07, 11.07it/s]Generating output:  74%|███████▍  | 222/300 [00:19<00:06, 11.17it/s]Generating output:  76%|███████▌  | 228/300 [00:20<00:06, 11.16it/s]Generating output:  78%|███████▊  | 234/300 [00:20<00:05, 11.20it/s]Generating output:  80%|████████  | 240/300 [00:21<00:05, 11.19it/s]Generating output:  82%|████████▏ | 247/300 [00:22<00:04, 11.28it/s]Generating output:  85%|████████▌ | 255/300 [00:22<00:03, 11.44it/s]Generating output:  87%|████████▋ | 261/300 [00:23<00:03, 11.46it/s]Generating output:  89%|████████▉ | 267/300 [00:23<00:02, 11.43it/s]Generating output:  92%|█████████▏| 276/300 [00:24<00:02, 11.71it/s]Generating output:  95%|█████████▌| 285/300 [00:24<00:01, 11.98it/s]Generating output:  98%|█████████▊| 294/300 [00:25<00:00, 12.29it/s]Generating output: 100%|██████████| 300/300 [00:25<00:00, 11.74it/s]
19:15:27 - INFO - Output video saved to: output_gem_global/Winter Cycling： Vantaa, Finland - 4K 60fps_matched.mp4
19:15:27 - INFO - Output images saved to: output_gem_global/matched_frames

Done!

real	3m10,655s
user	10m19,403s
sys	0m19,999s

==================================
All tests complete!
==================================

Comparison samples saved in:
  - output_avg_2x2/comparison_samples/
  - output_avg_3x3/comparison_samples/
  - output_avg_global/comparison_samples/
  - output_gem_2x2/comparison_samples/
  - output_gem_global/comparison_samples/

Creating side-by-side comparison images...
