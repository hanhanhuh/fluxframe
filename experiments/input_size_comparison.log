Testing input size impact on quality
Using GeM + global pooling for all tests

1/3: Testing 224px input (current baseline)
20:04:06 - INFO - Video: /home/birgit/Downloads/Winter Cycling： Vantaa, Finland - 4K 60fps.mp4
20:04:06 - INFO - Image folder: /home/birgit/fiftyone/open-images-v7/train/data
20:04:06 - INFO - Output directory: output_224px
20:04:06 - INFO - Search depth: 10
20:04:06 - INFO - Similarity threshold: 0.0
20:04:06 - INFO - No repeat: True
20:04:06 - INFO - Checkpoint batch size: 10
20:04:06 - INFO - Feature method: mobilenet
20:04:06 - INFO - Demo mode: ON (max 10s video, 1000 images)
20:04:06 - INFO - Weights - Edge: 0.33, Texture: 0.33, Color: 0.34
20:04:07 - INFO - FPS override: 25.0 (input: 59.94, skip interval: 2)
20:04:07 - INFO - Demo mode: Processing first 10 seconds (599 frames) out of 123084
20:04:07 - INFO - Scanning image folder...
20:05:49 - INFO - Sorting 467000 image paths...
20:06:02 - INFO - Demo mode: Using first 1000 images out of 467000
20:06:04 - INFO - Found 1000 images in folder
20:06:04 - INFO - Preparing FAISS index...
20:06:04 - INFO - Cache files not found, will rebuild
20:06:04 - INFO - Building FAISS index for 1000 images...
20:06:04 - INFO -   Comparison size: 256px
20:06:04 - INFO -   Using single-process mode (ONNX Runtime handles threading)
Computing features:   0%|          | 0/1000 [00:00<?, ?it/s]Computing features:   1%|          | 7/1000 [00:00<01:12, 13.75it/s]Computing features:   1%|▏         | 14/1000 [00:01<01:16, 12.83it/s]Computing features:   2%|▏         | 22/1000 [00:01<01:12, 13.52it/s]Computing features:   3%|▎         | 32/1000 [00:02<01:04, 14.90it/s]Computing features:   4%|▍         | 40/1000 [00:02<01:06, 14.49it/s]Computing features:   5%|▍         | 48/1000 [00:03<01:06, 14.40it/s]Computing features:   6%|▌         | 56/1000 [00:03<01:05, 14.41it/s]Computing features:   6%|▋         | 64/1000 [00:04<01:05, 14.18it/s]Computing features:   7%|▋         | 72/1000 [00:05<01:07, 13.72it/s]Computing features:   8%|▊         | 79/1000 [00:05<01:07, 13.65it/s]Computing features:   9%|▊         | 87/1000 [00:06<01:06, 13.83it/s]Computing features:   9%|▉         | 94/1000 [00:06<01:05, 13.74it/s]Computing features:  10%|█         | 101/1000 [00:07<01:08, 13.09it/s]Computing features:  11%|█         | 108/1000 [00:08<01:11, 12.42it/s]Computing features:  12%|█▏        | 116/1000 [00:08<01:09, 12.67it/s]Computing features:  13%|█▎        | 129/1000 [00:09<01:03, 13.62it/s]Computing features:  14%|█▍        | 140/1000 [00:09<01:00, 14.22it/s]Computing features:  15%|█▌        | 151/1000 [00:10<00:57, 14.72it/s]Computing features:  16%|█▌        | 162/1000 [00:11<00:55, 15.20it/s]Computing features:  18%|█▊        | 175/1000 [00:11<00:51, 15.92it/s]Computing features:  19%|█▉        | 189/1000 [00:12<00:48, 16.67it/s]Computing features:  20%|██        | 202/1000 [00:12<00:46, 17.23it/s]Computing features:  21%|██▏       | 214/1000 [00:13<00:44, 17.61it/s]Computing features:  23%|██▎       | 228/1000 [00:13<00:42, 18.20it/s]Computing features:  24%|██▍       | 239/1000 [00:14<00:41, 18.39it/s]Computing features:  25%|██▌       | 250/1000 [00:14<00:40, 18.53it/s]Computing features:  26%|██▌       | 260/1000 [00:15<00:39, 18.52it/s]Computing features:  27%|██▋       | 270/1000 [00:15<00:39, 18.36it/s]Computing features:  28%|██▊       | 280/1000 [00:16<00:39, 18.15it/s]Computing features:  29%|██▉       | 290/1000 [00:17<00:39, 17.98it/s]Computing features:  30%|███       | 300/1000 [00:17<00:39, 17.90it/s]Computing features:  31%|███       | 310/1000 [00:18<00:39, 17.58it/s]Computing features:  32%|███▏      | 320/1000 [00:19<00:38, 17.45it/s]Computing features:  33%|███▎      | 329/1000 [00:19<00:39, 17.18it/s]Computing features:  34%|███▍      | 338/1000 [00:20<00:38, 16.97it/s]Computing features:  35%|███▍      | 348/1000 [00:20<00:38, 17.06it/s]Computing features:  36%|███▌      | 358/1000 [00:21<00:37, 17.19it/s]Computing features:  37%|███▋      | 372/1000 [00:21<00:35, 17.69it/s]Computing features:  38%|███▊      | 385/1000 [00:22<00:34, 18.05it/s]Computing features:  40%|████      | 400/1000 [00:23<00:32, 18.60it/s]Computing features:  41%|████▏     | 414/1000 [00:23<00:30, 19.00it/s]Computing features:  43%|████▎     | 427/1000 [00:24<00:29, 19.34it/s]Computing features:  44%|████▎     | 437/1000 [00:24<00:29, 18.82it/s]Computing features:  45%|████▍     | 447/1000 [00:25<00:30, 18.21it/s]Computing features:  46%|████▌     | 457/1000 [00:26<00:31, 17.36it/s]Computing features:  47%|████▋     | 467/1000 [00:27<00:31, 17.08it/s]Computing features:  48%|████▊     | 477/1000 [00:28<00:31, 16.71it/s]Computing features:  49%|████▊     | 486/1000 [00:29<00:31, 16.31it/s]Computing features:  50%|████▉     | 495/1000 [00:29<00:31, 16.04it/s]Computing features:  50%|█████     | 504/1000 [00:30<00:31, 15.72it/s]Computing features:  51%|█████▏    | 513/1000 [00:31<00:31, 15.51it/s]Computing features:  52%|█████▏    | 522/1000 [00:32<00:31, 15.24it/s]Computing features:  53%|█████▎    | 531/1000 [00:33<00:31, 15.05it/s]Computing features:  54%|█████▍    | 540/1000 [00:33<00:30, 14.94it/s]Computing features:  55%|█████▍    | 548/1000 [00:34<00:30, 14.95it/s]Computing features:  56%|█████▌    | 556/1000 [00:34<00:29, 14.99it/s]Computing features:  56%|█████▋    | 564/1000 [00:35<00:29, 14.90it/s]Computing features:  57%|█████▋    | 572/1000 [00:36<00:28, 14.81it/s]Computing features:  58%|█████▊    | 580/1000 [00:36<00:28, 14.85it/s]Computing features:  59%|█████▉    | 588/1000 [00:37<00:28, 14.71it/s]Computing features:  60%|█████▉    | 596/1000 [00:37<00:27, 14.68it/s]Computing features:  60%|██████    | 604/1000 [00:38<00:26, 14.67it/s]Computing features:  61%|██████    | 612/1000 [00:38<00:26, 14.71it/s]Computing features:  62%|██████▏   | 620/1000 [00:39<00:25, 14.74it/s]Computing features:  63%|██████▎   | 628/1000 [00:39<00:25, 14.78it/s]Computing features:  64%|██████▎   | 636/1000 [00:40<00:24, 14.83it/s]Computing features:  64%|██████▍   | 644/1000 [00:40<00:24, 14.71it/s]Computing features:  65%|██████▌   | 652/1000 [00:41<00:23, 14.73it/s]Computing features:  66%|██████▌   | 660/1000 [00:42<00:23, 14.73it/s]Computing features:  67%|██████▋   | 668/1000 [00:42<00:22, 14.69it/s]Computing features:  68%|██████▊   | 676/1000 [00:43<00:22, 14.69it/s]Computing features:  68%|██████▊   | 685/1000 [00:43<00:21, 14.79it/s]Computing features:  69%|██████▉   | 693/1000 [00:44<00:20, 14.79it/s]Computing features:  70%|███████   | 702/1000 [00:44<00:19, 14.91it/s]Computing features:  71%|███████   | 710/1000 [00:45<00:19, 14.88it/s]Computing features:  72%|███████▏  | 720/1000 [00:45<00:18, 15.07it/s]Computing features:  73%|███████▎  | 728/1000 [00:46<00:18, 15.10it/s]Computing features:  74%|███████▍  | 738/1000 [00:46<00:17, 15.27it/s]Computing features:  75%|███████▍  | 746/1000 [00:47<00:16, 15.30it/s]Computing features:  76%|███████▌  | 755/1000 [00:47<00:15, 15.37it/s]Computing features:  76%|███████▋  | 763/1000 [00:48<00:15, 15.36it/s]Computing features:  77%|███████▋  | 771/1000 [00:49<00:14, 15.34it/s]Computing features:  78%|███████▊  | 779/1000 [00:49<00:14, 15.30it/s]Computing features:  79%|███████▉  | 788/1000 [00:50<00:13, 15.37it/s]Computing features:  80%|███████▉  | 796/1000 [00:50<00:13, 15.28it/s]Computing features:  81%|████████  | 807/1000 [00:51<00:12, 15.51it/s]Computing features:  82%|████████▏ | 815/1000 [00:51<00:11, 15.51it/s]Computing features:  82%|████████▏ | 823/1000 [00:52<00:11, 15.42it/s]Computing features:  83%|████████▎ | 833/1000 [00:52<00:10, 15.58it/s]Computing features:  84%|████████▍ | 841/1000 [00:53<00:10, 15.46it/s]Computing features:  85%|████████▌ | 850/1000 [00:54<00:09, 15.50it/s]Computing features:  86%|████████▌ | 858/1000 [00:54<00:09, 15.49it/s]Computing features:  87%|████████▋ | 866/1000 [00:55<00:08, 15.44it/s]Computing features:  87%|████████▋ | 874/1000 [00:55<00:08, 15.44it/s]Computing features:  88%|████████▊ | 882/1000 [00:56<00:07, 15.45it/s]Computing features:  89%|████████▉ | 890/1000 [00:56<00:07, 15.15it/s]Computing features:  90%|████████▉ | 898/1000 [00:57<00:06, 14.85it/s]Computing features:  91%|█████████ | 906/1000 [00:58<00:06, 14.56it/s]Computing features:  92%|█████████▏| 915/1000 [00:58<00:05, 14.61it/s]Computing features:  92%|█████████▏| 923/1000 [00:59<00:05, 14.53it/s]Computing features:  93%|█████████▎| 931/1000 [01:00<00:04, 14.57it/s]Computing features:  94%|█████████▍| 939/1000 [01:00<00:04, 14.53it/s]Computing features:  95%|█████████▍| 947/1000 [01:01<00:03, 14.52it/s]Computing features:  96%|█████████▌| 955/1000 [01:01<00:03, 14.44it/s]Computing features:  96%|█████████▋| 963/1000 [01:02<00:02, 14.48it/s]Computing features:  97%|█████████▋| 971/1000 [01:03<00:02, 14.32it/s]Computing features:  98%|█████████▊| 979/1000 [01:03<00:01, 14.27it/s]Computing features:  99%|█████████▊| 987/1000 [01:04<00:00, 14.21it/s]Computing features: 100%|█████████▉| 995/1000 [01:04<00:00, 14.29it/s]Computing features: 100%|██████████| 1000/1000 [01:05<00:00, 15.35it/s]
20:07:09 - INFO - Built flat FAISS index: 1000 images, dimension 24
20:07:09 - INFO - Saving FAISS cache...
20:07:09 - INFO - FAISS cache saved successfully
20:07:09 - INFO - Video aspect ratio: 1.778
20:07:09 - INFO - Processing 599 frames...
Matching frames:   0%|          | 0/599 [00:00<?, ?it/s]Matching frames:   1%|          | 5/599 [00:00<00:59,  9.98it/s]Matching frames:   3%|▎         | 16/599 [00:01<00:36, 16.14it/s]Matching frames:   7%|▋         | 39/599 [00:01<00:21, 26.36it/s]Matching frames:  11%|█         | 63/599 [00:02<00:16, 32.03it/s]Matching frames:  15%|█▍        | 88/599 [00:02<00:14, 35.87it/s]Matching frames:  19%|█▉        | 115/599 [00:03<00:12, 38.98it/s]Matching frames:  23%|██▎       | 137/599 [00:03<00:11, 39.37it/s]Matching frames:  27%|██▋       | 163/599 [00:04<00:10, 40.95it/s]Matching frames:  31%|███       | 184/599 [00:04<00:10, 40.58it/s]Matching frames:  35%|███▌      | 211/599 [00:05<00:09, 41.98it/s]Matching frames:  39%|███▊      | 232/599 [00:05<00:08, 40.83it/s]Matching frames:  43%|████▎     | 259/599 [00:06<00:08, 41.92it/s]Matching frames:  48%|████▊     | 287/599 [00:06<00:07, 43.23it/s]Matching frames:  53%|█████▎    | 315/599 [00:07<00:06, 44.20it/s]Matching frames:  57%|█████▋    | 339/599 [00:07<00:05, 44.15it/s]Matching frames:  61%|██████    | 365/599 [00:08<00:05, 44.73it/s]Matching frames:  65%|██████▌   | 391/599 [00:08<00:04, 45.20it/s]Matching frames:  70%|██████▉   | 419/599 [00:09<00:03, 45.91it/s]Matching frames:  74%|███████▍  | 445/599 [00:09<00:03, 46.35it/s]Matching frames:  78%|███████▊  | 469/599 [00:10<00:02, 44.68it/s]Matching frames:  82%|████████▏ | 492/599 [00:11<00:02, 44.11it/s]Matching frames:  86%|████████▌ | 515/599 [00:11<00:01, 43.34it/s]Matching frames:  90%|████████▉ | 538/599 [00:12<00:01, 43.14it/s]Matching frames:  93%|█████████▎| 560/599 [00:13<00:00, 42.35it/s]Matching frames:  97%|█████████▋| 582/599 [00:13<00:00, 42.21it/s]Matching frames: 100%|██████████| 599/599 [00:14<00:00, 42.13it/s]
20:07:24 - INFO - Results saved to output_224px/results.json
20:07:24 - INFO - Verification: All frames have valid selections
20:07:24 - INFO - Generating output...
20:07:24 - INFO - Output FPS: 25.0 (input: 59.94)
Generating output:   0%|          | 0/300 [00:00<?, ?it/s]Generating output:   4%|▎         | 11/300 [00:00<00:14, 19.60it/s]Generating output:   7%|▋         | 21/300 [00:01<00:14, 19.78it/s]Generating output:  10%|█         | 31/300 [00:01<00:13, 19.57it/s]Generating output:  14%|█▎        | 41/300 [00:02<00:13, 19.65it/s]Generating output:  17%|█▋        | 51/300 [00:02<00:13, 18.87it/s]Generating output:  20%|██        | 61/300 [00:03<00:12, 18.69it/s]Generating output:  24%|██▍       | 72/300 [00:03<00:11, 19.15it/s]Generating output:  27%|██▋       | 82/300 [00:04<00:11, 19.02it/s]Generating output:  31%|███       | 92/300 [00:04<00:11, 18.79it/s]Generating output:  34%|███▍      | 103/300 [00:05<00:10, 19.03it/s]Generating output:  38%|███▊      | 114/300 [00:05<00:09, 19.21it/s]Generating output:  42%|████▏     | 126/300 [00:06<00:08, 19.56it/s]Generating output:  45%|████▌     | 136/300 [00:07<00:08, 19.48it/s]Generating output:  49%|████▊     | 146/300 [00:07<00:08, 18.63it/s]Generating output:  52%|█████▏    | 156/300 [00:08<00:07, 18.66it/s]Generating output:  57%|█████▋    | 172/300 [00:08<00:06, 19.73it/s]Generating output:  63%|██████▎   | 190/300 [00:09<00:05, 20.92it/s]Generating output:  69%|██████▊   | 206/300 [00:09<00:04, 21.75it/s]Generating output:  74%|███████▍  | 222/300 [00:10<00:03, 22.48it/s]Generating output:  80%|████████  | 240/300 [00:10<00:02, 23.41it/s]Generating output:  86%|████████▌ | 257/300 [00:11<00:01, 24.03it/s]Generating output:  92%|█████████▏| 275/300 [00:11<00:01, 24.82it/s]Generating output:  98%|█████████▊| 295/300 [00:12<00:00, 25.77it/s]Generating output: 100%|██████████| 300/300 [00:12<00:00, 23.91it/s]
20:07:37 - INFO - Output video saved to: output_224px/Winter Cycling： Vantaa, Finland - 4K 60fps_matched.mp4
20:07:37 - INFO - Output images saved to: output_224px/matched_frames

Done!

real	3m32,364s
user	7m54,954s
sys	0m48,628s

2/3: Testing 128px input (~2x faster preprocessing)
20:07:37 - INFO - Video: /home/birgit/Downloads/Winter Cycling： Vantaa, Finland - 4K 60fps.mp4
20:07:37 - INFO - Image folder: /home/birgit/fiftyone/open-images-v7/train/data
20:07:37 - INFO - Output directory: output_128px
20:07:37 - INFO - Search depth: 10
20:07:37 - INFO - Similarity threshold: 0.0
20:07:37 - INFO - No repeat: True
20:07:37 - INFO - Checkpoint batch size: 10
20:07:37 - INFO - Feature method: mobilenet
20:07:37 - INFO - Demo mode: ON (max 10s video, 1000 images)
20:07:37 - INFO - Weights - Edge: 0.33, Texture: 0.33, Color: 0.34
20:07:38 - INFO - FPS override: 25.0 (input: 59.94, skip interval: 2)
20:07:38 - INFO - Demo mode: Processing first 10 seconds (599 frames) out of 123084
20:07:38 - INFO - Scanning image folder...
20:07:45 - INFO - Sorting 467000 image paths...
20:08:00 - INFO - Demo mode: Using first 1000 images out of 467000
20:08:02 - INFO - Found 1000 images in folder
20:08:02 - INFO - Preparing FAISS index...
20:08:02 - INFO - Cache files not found, will rebuild
20:08:02 - INFO - Building FAISS index for 1000 images...
20:08:02 - INFO -   Comparison size: 128px
20:08:02 - INFO -   Using single-process mode (ONNX Runtime handles threading)
Computing features:   0%|          | 0/1000 [00:00<?, ?it/s]Computing features:   1%|          | 8/1000 [00:00<01:10, 14.10it/s]Computing features:   2%|▏         | 17/1000 [00:01<01:04, 15.24it/s]Computing features:   2%|▎         | 25/1000 [00:01<01:05, 14.84it/s]Computing features:   3%|▎         | 34/1000 [00:02<01:02, 15.57it/s]Computing features:   4%|▍         | 42/1000 [00:02<01:01, 15.62it/s]Computing features:   5%|▌         | 50/1000 [00:03<01:01, 15.39it/s]Computing features:   6%|▌         | 58/1000 [00:03<01:00, 15.45it/s]Computing features:   7%|▋         | 66/1000 [00:04<01:01, 15.20it/s]Computing features:   7%|▋         | 74/1000 [00:04<01:02, 14.83it/s]Computing features:   8%|▊         | 82/1000 [00:05<01:02, 14.80it/s]Computing features:   9%|▉         | 91/1000 [00:06<01:00, 14.98it/s]Computing features:  10%|▉         | 99/1000 [00:06<01:00, 14.99it/s]Computing features:  11%|█         | 107/1000 [00:07<00:59, 14.89it/s]Computing features:  12%|█▏        | 115/1000 [00:07<01:00, 14.62it/s]Computing features:  12%|█▏        | 123/1000 [00:08<01:00, 14.57it/s]Computing features:  13%|█▎        | 131/1000 [00:08<01:00, 14.45it/s]